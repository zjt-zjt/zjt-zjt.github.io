<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://zjt-zjt.github.io</id>
    <title>Gridea</title>
    <updated>2019-12-11T11:04:25.328Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://zjt-zjt.github.io"/>
    <link rel="self" href="https://zjt-zjt.github.io/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://zjt-zjt.github.io/images/avatar.png</logo>
    <icon>https://zjt-zjt.github.io/favicon.ico</icon>
    <rights>All rights reserved 2019, Gridea</rights>
    <entry>
        <title type="html"><![CDATA[Hello Gridea]]></title>
        <id>https://zjt-zjt.github.io/post/hello-gridea</id>
        <link href="https://zjt-zjt.github.io/post/hello-gridea">
        </link>
        <updated>2018-12-11T16:00:00.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
<!-- more -->
<p><a href="https://github.com/getgridea/gridea">Github</a><br>
<a href="https://gridea.dev/">Gridea ä¸»é¡µ</a><br>
<a href="http://fehey.com/">ç¤ºä¾‹ç½‘ç«™</a></p>
<h2 id="ç‰¹æ€§">ç‰¹æ€§ğŸ‘‡</h2>
<p>ğŸ“  ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ <strong>Markdown</strong> è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ</p>
<p>ğŸŒ‰  ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡</p>
<p>ğŸ·ï¸  ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„</p>
<p>ğŸ“‹  ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå•</p>
<p>ğŸ’»  ä½ å¯ä»¥åœ¨ <strong>Windows</strong>ï¼Œ<strong>MacOS</strong> æˆ– <strong>Linux</strong> è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯</p>
<p>ğŸŒ  ä½ å¯ä»¥ä½¿ç”¨ <strong>ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ</strong> æˆ– <strong>Coding Pages</strong> å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å°</p>
<p>ğŸ’¬  ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ <a href="https://github.com/gitalk/gitalk">Gitalk</a> æˆ– <a href="https://github.com/SukkaW/DisqusJS">DisqusJS</a> è¯„è®ºç³»ç»Ÿ</p>
<p>ğŸ‡¬ğŸ‡§  ä½ å¯ä»¥ä½¿ç”¨<strong>ä¸­æ–‡ç®€ä½“</strong>æˆ–<strong>è‹±è¯­</strong></p>
<p>ğŸŒ  ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ›</p>
<p>ğŸ–¥  ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥</p>
<p>ğŸŒ± å½“ç„¶ <strong>Gridea</strong> è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ ğŸƒ</p>
<p>æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´</p>
<p>å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼</p>
<p>ğŸ˜˜ Enjoy~</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[SpringMVC]]></title>
        <id>https://zjt-zjt.github.io/post/springmvc-xue-xi-bi-ji</id>
        <link href="https://zjt-zjt.github.io/post/springmvc-xue-xi-bi-ji">
        </link>
        <updated>2018-11-08T13:28:02.000Z</updated>
        <summary type="html"><![CDATA[<!-- SpringMVC ç¬¬ä¸€å¤© -->
<h2 id="mvcè®¾è®¡æ¨¡å¼">MVCè®¾è®¡æ¨¡å¼</h2>
<p>å…¶å®åœ¨ä¹‹å‰JavaWebé˜¶æ®µæˆ‘ä»¬å·²ç»æ¥è§¦åˆ°äº†MVCæ¨¡å¼ã€‚</p>
<p>MVCé‡Œé¢çš„MæŒ‡çš„çš„Modelï¼ˆé€šå¸¸åŒ…å«beanã€dao(mapper)ã€serviceï¼‰ï¼›VæŒ‡çš„æ˜¯Viewï¼Œè§†å›¾å±‚ï¼Œè§†å›¾å±‚ä¸»è¦çš„æŠ€æœ¯ï¼ˆJSPã€HTMLã€FreeMakerã€Themeleafï¼‰ï¼›CæŒ‡çš„æ˜¯Controllerï¼Œæ§åˆ¶å±‚ã€‚æ§åˆ¶å±‚ä¸è´Ÿè´£å…·ä½“æ•°æ®ã€é€»è¾‘çš„å¤„ç†å’Œè¿ç®—ï¼Œå®ƒåªè´Ÿè´£å°†Modelå±‚çš„ç»“æœè¿”å›ç»™å¯¹åº”çš„è§†å›¾å±‚å»å±•ç¤ºã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<!-- SpringMVC ç¬¬ä¸€å¤© -->
<h2 id="mvcè®¾è®¡æ¨¡å¼">MVCè®¾è®¡æ¨¡å¼</h2>
<p>å…¶å®åœ¨ä¹‹å‰JavaWebé˜¶æ®µæˆ‘ä»¬å·²ç»æ¥è§¦åˆ°äº†MVCæ¨¡å¼ã€‚</p>
<p>MVCé‡Œé¢çš„MæŒ‡çš„çš„Modelï¼ˆé€šå¸¸åŒ…å«beanã€dao(mapper)ã€serviceï¼‰ï¼›VæŒ‡çš„æ˜¯Viewï¼Œè§†å›¾å±‚ï¼Œè§†å›¾å±‚ä¸»è¦çš„æŠ€æœ¯ï¼ˆJSPã€HTMLã€FreeMakerã€Themeleafï¼‰ï¼›CæŒ‡çš„æ˜¯Controllerï¼Œæ§åˆ¶å±‚ã€‚æ§åˆ¶å±‚ä¸è´Ÿè´£å…·ä½“æ•°æ®ã€é€»è¾‘çš„å¤„ç†å’Œè¿ç®—ï¼Œå®ƒåªè´Ÿè´£å°†Modelå±‚çš„ç»“æœè¿”å›ç»™å¯¹åº”çš„è§†å›¾å±‚å»å±•ç¤ºã€‚</p>
<!-- more -->
<p>åœ¨JavaWebé˜¶æ®µï¼Œ Controllerå±‚æŒ‡çš„å°±æ˜¯Servletï¼› Viewå±‚æŒ‡çš„å°±æ˜¯JSPæˆ–è€…HTML;  Modelå±‚æŒ‡çš„å°±æ˜¯beanã€daoã€serviceã€‚</p>
<p>åœ¨J2EEé˜¶æ®µï¼ŒControllerå±‚æŒ‡çš„å°±æ˜¯SpringMVCã€Structs1\2ï¼›  Viewå±‚ä¸å˜è¿˜æ˜¯ä¸»æµçš„é¡µé¢å±•ç¤ºæŠ€æœ¯; Modelå±‚åŒ…æ‹¬beanã€mybatisã€serviceã€‚</p>
<h2 id="springmvcçš„ä¼˜åŠ¿">SpringMVCçš„ä¼˜åŠ¿</h2>
<ul>
<li>SpringMVCæ˜¯ä¸€æ¬¾å¾ˆè½»é‡çº§çš„æ¡†æ¶ï¼Œè¦ä½¿ç”¨å®ƒçš„ç»„ä»¶æˆ‘ä»¬å¾€å¾€åªéœ€è¦å®šä¹‰ä¸€äº›æœ€ç®€å•çš„Javaç±»ï¼Œç„¶åæ·»åŠ æŸäº›æ³¨è§£å°±å¯ä»¥äº†</li>
<li>SpringMVCçš„å‚æ•°æ³¨å…¥åªç›´æ¥æ³¨å…¥åˆ°æ–¹æ³•ä¸­ï¼Œå¯ä»¥å¾ˆå¥½çš„åšåˆ°ä¸åŒè¯·æ±‚é—´æ•°æ®çš„éš”ç¦»ï¼Œè€ŒStruts2æ˜¯æ³¨å…¥åˆ°ç±»å®ä¾‹å˜é‡ä¸Šï¼Œä¸åŒçš„è¯·æ±‚å¯èƒ½ä¼šè¦†ç›–å‚æ•°ã€‚</li>
<li>SpringMVCå¯ä»¥å¾ˆè½»æ˜“çš„å’ŒSpringæ•´åˆï¼Œè€ŒStrutséœ€è¦åšæ¯”è¾ƒå¤æ‚çš„é…ç½®ã€‚</li>
</ul>
<h2 id="springmvcç®€å•ä½¿ç”¨">SpringMVCç®€å•ä½¿ç”¨</h2>
<ol>
<li>
<p>æ·»åŠ ä¾èµ–</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
    &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
    &lt;version&gt;5.2.0.RELEASE&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
</li>
<li>
<p>åœ¨web.xmlä¸­é…ç½®DispatcherServlet</p>
<pre><code class="language-xml">&lt;servlet&gt;
    &lt;servlet-name&gt;aa&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
    &lt;!-- æŒ‡å®šSpringMVC é…ç½®æ–‡ä»¶ä½ç½®ï¼ŒDispatcherServletåˆå§‹åŒ–æ—¶ä¼šåˆå§‹åŒ–Springä¸Šä¸‹æ–‡ï¼ˆWebApplicationContextï¼‰ --&gt;
    &lt;!-- é»˜è®¤é…ç½®æ–‡ä»¶å¯»æ‰¾ä½ç½®ï¼š/WEB-INF/{servlet-name}-servlet.xmlï¼Œå¦‚æœåå­—ç¬¦åˆé»˜è®¤å¯»æ‰¾è§„åˆ™ï¼Œå¯ä»¥ä¸æŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„ --&gt;
    &lt;!--&lt;init-param&gt;
      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
      &lt;param-value&gt;/WEB-INF/aa-servlet.xml&lt;/param-value&gt;
    &lt;/init-param&gt;--&gt;
    &lt;!-- é…ç½®å®¹å™¨å¯åŠ¨æ—¶åˆå§‹åŒ–DispatcherServlet --&gt;
    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;aa&lt;/servlet-name&gt;
    &lt;!-- æ˜ å°„è·¯å¾„é…ç½®æˆ/ï¼Œä»£è¡¨å½“å‰Servletæ˜¯ä¸€ä¸ªé»˜è®¤Servletï¼Œå°±æ˜¯å½“å…¶ä»–Servletéƒ½æ— æ³•å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±é»˜è®¤Servletå‡ºé©¬ --&gt;
    &lt;url-pattern&gt;/&lt;/url-pattern&gt;
&lt;!--    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;--&gt;
  &lt;/servlet-mapping&gt;
</code></pre>
</li>
<li>
<p>é…ç½®SpringMVC  dispatcher-servlet.xml</p>
<p>SpringMVCå¤§éƒ¨åˆ†ç»„ä»¶éƒ½æœ‰é»˜è®¤é…ç½®ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç®€å•åº”ç”¨åªéœ€è¦æŒ‡å®šè§†å›¾è§£æå™¨å°±è¡Œäº†</p>
<p>dispatcher-servlet.xml</p>
<pre><code class="language-xml">&lt;!-- é…ç½®è§†å›¾è§£æå™¨ï¼Œç”¨äºå°†Handleræ–¹æ³•ä¸­è¿”å›çš„è§†å›¾åè§£ææˆçœŸæ­£å¯å±•ç¤ºçš„é¡µé¢ --&gt;
&lt;mvc:view-resolvers&gt;
    &lt;bean class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;
        &lt;property name=&quot;prefix&quot; value=&quot;/&quot; /&gt;
        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot; /&gt;
    &lt;/bean&gt;
&lt;/mvc:view-resolvers&gt;
</code></pre>
</li>
<li>
<p>å®šä¹‰Controller</p>
<p>æ–°å»ºä¸€ä¸ªæ™®é€šç±»ï¼Œç„¶åæ·»åŠ <code>@Controller</code>æ³¨è§£ï¼Œå°±å¯ä»¥äº†</p>
</li>
<li>
<p>å®šä¹‰è¯·æ±‚å¤„ç†æ–¹æ³•(Handler)</p>
<p>åœ¨Controllerç±»ä¸­å®šä¹‰ä¸€ä¸ªæ™®é€šçš„æ–¹æ³•ï¼Œæ·»åŠ <code>@RequestMapping</code>æ³¨è§£å°±å¯ä»¥äº†</p>
</li>
</ol>
<h2 id="springmvcä¸»è¦ç»„ä»¶">SpringMVCä¸»è¦ç»„ä»¶</h2>
<h3 id="rootapplicationcontextå’Œservletapplicationcontext">RootApplicationContextå’ŒServletApplicationContext</h3>
<figure data-type="image" tabindex="1"><img src="https://docs.spring.io/spring/docs/5.2.0.RELEASE/spring-framework-reference/images/mvc-context-hierarchy.png" alt="çˆ¶å­ä¸Šä¸‹æ–‡æ¦‚å¿µ"></figure>
<h4 id="ä¸¤ä¸ªapplicationcontextçš„è”ç³»å’ŒåŒºåˆ«">ä¸¤ä¸ªApplicationContextçš„è”ç³»å’ŒåŒºåˆ«</h4>
<h3 id="è§†å›¾è§£æå™¨">è§†å›¾è§£æå™¨</h3>
<p>è§†å›¾è§£æå™¨çš„ä½œç”¨æ˜¯å°†è¯·æ±‚å¤„ç†æ–¹æ³•ä¸­çš„è¿”å›å€¼è§£ææˆä¸€ä¸ªçœŸæ­£å¯ä»¥æ¸²æŸ“çš„é¡µé¢ã€‚</p>
<h4 id="å¸¸ç”¨çš„è§†å›¾è§£æå™¨">å¸¸ç”¨çš„è§†å›¾è§£æå™¨</h4>
<ul>
<li>
<p>InternalResourceViewResolver</p>
<p>å†…éƒ¨èµ„æºè§£æå™¨ï¼š ç”¨äºå°†è¿”å›å€¼å¯¹åº”åˆ°é¡¹ç›®è·¯å¾„ä¸‹çš„æŸä¸ªå¯æ˜¾ç¤ºçš„é¡µé¢ã€‚æ¯”å¦‚æ–¹æ³•è¿”å›å€¼æ˜¯indexå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆ<code>InternalResourceViewResolver</code>è§£æå™¨ä¼šåœ¨indexå‰åŠ ä¸ŠæŒ‡å®šçš„å‰ç¼€ï¼Œåœ¨indexååŠ ä¸ŠæŒ‡å®šçš„åç¼€æ¥æ‹¼æ¥æˆæŒ‡å‘æŸä¸ªè§†å›¾çš„è·¯å¾„ã€‚</p>
<pre><code class="language-xml">&lt;!-- é…ç½®è§†å›¾è§£æå™¨ï¼Œç”¨äºå°†Handleræ–¹æ³•ä¸­è¿”å›çš„è§†å›¾åè§£ææˆçœŸæ­£å¯å±•ç¤ºçš„é¡µé¢ --&gt;
&lt;mvc:view-resolvers&gt;
    &lt;bean class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;
        &lt;property name=&quot;prefix&quot; value=&quot;/&quot; /&gt;
        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot; /&gt;
    &lt;/bean&gt;
&lt;/mvc:view-resolvers&gt;
</code></pre>
</li>
</ul>
<h3 id="å‚æ•°ä¼ é€’">å‚æ•°ä¼ é€’</h3>
<h4 id="é¡µé¢å‚æ•°ä¼ é€’åˆ°controller">é¡µé¢å‚æ•°ä¼ é€’åˆ°Controller</h4>
<h5 id="requestparam">@RequestParam</h5>
<p>è·å–è¯·æ±‚å‚æ•°ï¼ŒåŒ…æ‹¬é€šè¿‡GETè¯·æ±‚ä¸­çš„æŸ¥è¯¢å‚æ•°ã€POSTè¯·æ±‚ä¸­çš„å‚æ•°ç­‰</p>
<pre><code class="language-java">@RequestMapping(&quot;/hello&quot;)
public String toHelloPage(@RequestParam String message, Model model) {
	model.addAttribute(&quot;msg&quot;, message);
	return &quot;hello_springmvc&quot;;
}


// å½“æ–¹æ³•å‚æ•°åå’Œè¯·æ±‚å‚æ•°ä¸ä¸€æ ·æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ³¨è§£çš„å‚æ•°å¯¹åº”èµ·æ¥
@RequestMapping(&quot;/hello&quot;)
public String toHelloPage(@RequestParam(&quot;message&quot;) String msg, Model model) {
	model.addAttribute(&quot;msg&quot;, message);
	return &quot;hello_springmvc&quot;;
}
</code></pre>
<blockquote>
<p>è®¿é—®: http://localhost:8080/hello?message=zhangsan æ—¶ï¼Œmessageå‚æ•°ä¼šè‡ªåŠ¨æ³¨å…¥åˆ°æ–¹æ³•çš„messageå‚æ•°ä¸­ã€‚</p>
</blockquote>
<h5 id="requestheader">@RequestHeader</h5>
<p>è·å–è¯·æ±‚å¤´ä¸­çš„å‚æ•°ï¼Œå¦‚æµè§ˆå™¨é»˜è®¤è‡ªå¸¦çš„userAgentå°±æ˜¯è¯·æ±‚å¤´å‚æ•°</p>
<pre><code class="language-java">@RequestMapping(&quot;/hello&quot;)
public String toHelloPage(@RequestHeader String userAgent, Model model) {
	model.addAttribute(&quot;msg&quot;, userAgent);
	return &quot;hello_springmvc&quot;;
}


// å½“æ–¹æ³•å‚æ•°åå’Œè¯·æ±‚å¤´å‚æ•°ä¸ä¸€æ ·æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ³¨è§£çš„å‚æ•°å¯¹åº”èµ·æ¥
@RequestMapping(&quot;/hello&quot;)
public String toHelloPage(@RequestHeader(&quot;userAgent&quot;) String ua, Model model) {
	model.addAttribute(&quot;msg&quot;, ua);
	return &quot;hello_springmvc&quot;;
}
</code></pre>
<blockquote>
<p>ä¼šè‡ªåŠ¨å°†è¯·æ±‚å¤´ä¸­çš„userAgentå‚æ•°æ³¨å…¥åˆ°æ–¹æ³•ä¸­</p>
</blockquote>
<h5 id="pathvariable">@PathVariable</h5>
<p>è·å–è¯·æ±‚åœ°å€ä¸­çš„å‚æ•°ï¼Œæ³¨å…¥åˆ°æ–¹æ³•å‚æ•°ä¸­</p>
<pre><code class="language-java">@RequestMapping(&quot;/hello/{sname}&quot;)
public String toHelloPage(@PathVariable String sname, Model model) {
	model.addAttribute(&quot;msg&quot;, sname);
	return &quot;hello_springmvc&quot;;
}


// å½“æ–¹æ³•å‚æ•°åå’Œè¯·æ±‚åœ°å€ä¸­å‚æ•°ä¸ä¸€æ ·æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ³¨è§£çš„å‚æ•°å¯¹åº”èµ·æ¥
@RequestMapping(&quot;/hello/{sname}&quot;)
public String toHelloPage(@PathVariable(&quot;sname&quot;) String sn, Model model) {
	model.addAttribute(&quot;msg&quot;, sn);
	return &quot;hello_springmvc&quot;;
}
</code></pre>
<blockquote>
<p>è®¿é—®ï¼šhttp://localhost:8080/hello/zhangsan  ä¼šè‡ªåŠ¨å°†zhangsanæ³¨å…¥åˆ°æ–¹æ³•çš„å‚æ•°ä¸­</p>
</blockquote>
<h5 id="requestattribute">@RequestAttribute</h5>
<p>jspä¸­</p>
<pre><code class="language-jsp">&lt;%
        request.setAttribute(&quot;sname&quot;, &quot;è™å§¬req&quot;);
        request.getRequestDispatcher(&quot;/param/req_scope&quot;).forward(request, response);
%&gt;
</code></pre>
<p>Controllerä¸­</p>
<pre><code class="language-java">/**
  * è¯·æ±‚ä½œç”¨åŸŸä¸­çš„å‚æ•°çš„ä¼ é€’
  * @return
  */
@RequestMapping(&quot;/req_scope&quot;)
public String requestScopeParamShow(@RequestAttribute String sname, Model model) {
    model.addAttribute(&quot;sname&quot;, sname);
    model.addAttribute(&quot;type&quot;, &quot;è¯·æ±‚ä½œç”¨åŸŸå‚æ•°&quot;);
    return &quot;param_show&quot;;
}

</code></pre>
<blockquote>
<p>è·å–è¯·æ±‚ä½œç”¨åŸŸä¸­çš„å‚æ•°</p>
</blockquote>
<h5 id="sessionattribute">@SessionAttribute</h5>
<blockquote>
<p>è·å–Sessionä½œç”¨åŸŸä¸­çš„å‚æ•°ï¼Œç”¨æ³•å’Œä¸Šé¢è¯·æ±‚ä½œç”¨åŸŸä¸­ä½¿ç”¨ç±»ä¼¼</p>
</blockquote>
<h5 id="cookievalue">@CookieValue</h5>
<p>jspä¸­ä»£ç </p>
<pre><code class="language-jsp">cookieå‚æ•°ä¼ é€’ï¼š&lt;br /&gt;
&lt;%
response.addCookie(new Cookie(&quot;sname&quot;, &quot;yuji_cookie&quot;));
%&gt;
&lt;a href=&quot;/param/cookie&quot;&gt;å‘èµ·è¯·æ±‚&lt;/a&gt;

</code></pre>
<p>Controllerä¸­</p>
<pre><code class="language-java">/**
  * Cookieä¸­çš„å‚æ•°çš„ä¼ é€’
  * @return
  */
@RequestMapping(&quot;/cookie&quot;)
public String cookieParamShow(@CookieValue String sname, Model model) {
    model.addAttribute(&quot;sname&quot;, sname);
    model.addAttribute(&quot;type&quot;, &quot;cookieå‚æ•°&quot;);
    return &quot;param_show&quot;;
}

</code></pre>
<blockquote>
<p>è·å–Cookieä¸­çš„æŒ‡å®šæ•°æ®</p>
</blockquote>
<blockquote>
<p>ä¸Šé¢è¿™å‡ ä¸ªæ³¨è§£éƒ½æ˜¯ç”¨äºåœ¨æ–¹æ³•çš„å‚æ•°ä¸Šæ ‡æ³¨ï¼Œç”¨äºè·å–ä¸åŒç§ç±»çš„å‚æ•°</p>
</blockquote>
<h4 id="controllerä¸­çš„æ•°æ®ä¼ é€’åˆ°é¡µé¢">Controllerä¸­çš„æ•°æ®ä¼ é€’åˆ°é¡µé¢</h4>
<h5 id="model">Model</h5>
<p>handleræ–¹æ³•å®šä¹‰ï¼š</p>
<pre><code class="language-java">@RequestMapping(&quot;/show_msg&quot;)
public String showMessage(Model model) {
    model.addAttribute(&quot;msg&quot;, &quot;æˆ‘æ˜¯é€šè¿‡modelä¼ è¿‡æ¥çš„å‚æ•°&quot;);
    return &quot;message_page&quot;;
}

</code></pre>
<p>message_page.jsp</p>
<pre><code class="language-jsp">&lt;h1&gt;
    è·å–åå°å‚æ•°ï¼š ${msg}
&lt;/h1&gt;

</code></pre>
<h5 id="modelandview">ModelAndView</h5>
<pre><code class="language-java">/**
 * ModelAndViewå…¶å®æ˜¯å°†æ•°æ®Modelå’Œè§†å›¾Viewåšäº†ä¸€ä¸ªå°è£…ï¼Œåº•å±‚å®ç°åŸç†ä¸€æ ·
 */
@RequestMapping(&quot;/show_msg&quot;)
public ModelAndView showMessage(ModelAndView mv) {
    mv.addObject(&quot;msg&quot;, &quot;æˆ‘æ˜¯é€šè¿‡modelä¼ è¿‡æ¥çš„å‚æ•°&quot;);
    mv.setViewName(&quot;message_page&quot;);
    return mv;
}

</code></pre>
<blockquote>
<p>Modelå’ŒModelAndViewä¼ é€’çš„å‚æ•°æœ¬è´¨ä¸Šä¹Ÿæ˜¯ç”¨è¯·æ±‚ä½œç”¨åŸŸæ¥å®ç°çš„ï¼Œæ‰€ä»¥ä»…å¯¹è¯·æ±‚è½¬å‘æœ‰æ•ˆã€‚</p>
</blockquote>
<h3 id="è§†å›¾æ§åˆ¶å™¨">è§†å›¾æ§åˆ¶å™¨</h3>
<p>ç”¨äºé€šè¿‡é…ç½®çš„æ–¹å¼ç®€åŒ–æˆ‘ä»¬é¡¹ç›®ä¸­ä¸å«ä¸šåŠ¡é€»è¾‘çš„é¡µé¢è·³è½¬ï¼Œçœå»äº†æˆ‘ä»¬å†™ä¸€ä¸ªç©ºæ–¹æ³•çš„æ­¥éª¤ã€‚</p>
<h4 id="è§†å›¾æ§åˆ¶å™¨çš„ä½œç”¨å’Œç”¨æ³•">è§†å›¾æ§åˆ¶å™¨çš„ä½œç”¨å’Œç”¨æ³•</h4>
<p>è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬çš„å·¥ç¨‹ä¸­æœ‰è¿™æ ·çš„ä¸€ä¸ªéœ€æ±‚ï¼Œæ¯”å¦‚å½“ç”¨æˆ·ç‚¹äº†æŸä¸ªé“¾æ¥å’ŒæŒ‰é’®çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€ä¸ªé¡µé¢è·³è½¬ï¼Œè¿™ä¸ªè·³è½¬çš„ç›®æ ‡å¯èƒ½æ˜¯ä¸€ä¸ªå…¬å¼€ç›®å½•çš„é¡µé¢ä¹Ÿå¯èƒ½æ˜¯ç§æœ‰ç›®å½•ï¼ˆ/WEB-INF/ä¸‹ï¼‰çš„é¡µé¢ã€è¿˜å¯èƒ½æ˜¯è·³è½¬åˆ°åå°Controllerçš„æŸä¸ªæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¦‚ä½•å®ç°ï¼Ÿ</p>
<p>ç¤ºä¾‹ï¼šæ¯”å¦‚æˆ‘ä»¬æƒ³å°†ç™»é™†é¡µè®¾ç½®ä¸ºä¸€ä¸ªé¡¹ç›®é»˜è®¤æ¬¢è¿é¡µé¢</p>
<p>æ–¹æ¡ˆä¸€ï¼šåœ¨Controllerä¸­æ·»åŠ ä¸€ä¸ªæ‹¦æˆª/çš„handleræ–¹æ³•</p>
<pre><code class="language-java">@RequestMapping(&quot;/&quot;)
public String toWelcomePage() {
    return &quot;login&quot;;
}

</code></pre>
<p>æ–¹æ³•äºŒï¼šä½¿ç”¨è§†å›¾æ§åˆ¶å™¨</p>
<p>åœ¨dispatcher-servlet.xmlï¼ˆSpringMVCé…ç½®æ–‡ä»¶ï¼‰é…ç½®ä¸­æ·»åŠ </p>
<pre><code class="language-xml">&lt;mvc:view-controller path=&quot;/&quot; view-name=&quot;login&quot; /&gt;

</code></pre>
<ul>
<li>path: æŒ‡å®šè¦åŒ¹é…çš„è®¿é—®è·¯å¾„</li>
<li>view-name: è¿”å›çš„é€»è¾‘è§†å›¾å</li>
<li>status-code: è®¾ç½®å“åº”çŠ¶æ€ç ã€‚(æ³¨ï¼šä¸èƒ½é€šè¿‡åªè®¾ç½®çŠ¶æ€ç ï¼Œä¸è®¾ç½®view-nameå®ç°åªè¿”å›codeï¼Œæ²¡æœ‰é¡µé¢çš„å¤„ç†)</li>
</ul>
<blockquote>
<p>view-nameä¸ä»…å¯ä»¥æ˜¯é€»è¾‘è§†å›¾åï¼Œè¿˜å¯ä»¥æ·»åŠ forwardã€redirectå‰ç¼€ï¼Œé€šè¿‡è½¬å‘æˆ–é‡å®šå‘çš„æ–¹å¼è·³è½¬åˆ°ä¸€ä¸ªå…·ä½“çš„è·¯å¾„ï¼Œå¦‚ï¼š&lt;mvc:view-controller path=&quot;/&quot; view-anme=&quot;forward:/WEB-INF/login.jsp&quot; /&gt;</p>
</blockquote>
<!-- SpringMVC ç¬¬äºŒå¤© -->
<h3 id="è®¾ç½®webé¡¹ç›®çš„é»˜è®¤æ¬¢è¿é¡µ">è®¾ç½®Webé¡¹ç›®çš„é»˜è®¤æ¬¢è¿é¡µ</h3>
<ul>
<li>
<p>åœ¨web.xmlä¸­ä½¿ç”¨<welcome-file-list>æ ‡ç­¾æŒ‡å®š</p>
</li>
<li>
<p>ä½¿ç”¨ä¸Šé¢æåˆ°çš„è§†å›¾æ§åˆ¶å™¨</p>
<pre><code class="language-xml">&lt;mvc:view-controller path=&quot;/&quot; view-name=&quot;é€»è¾‘è§†å›¾å&quot; /&gt;
&lt;!-- å½“å·¥ç¨‹ä¸­å­˜åœ¨Tomcaté»˜è®¤æ¬¢è¿é¡µåŒåæ–‡ä»¶æ—¶æ­¤ç§æ–¹å¼å¯èƒ½å¤±æ•ˆï¼Œæ¯”å¦‚index.htmlã€index.jspã€index.htm --&gt;

</code></pre>
</li>
</ul>
<h3 id="é™æ€èµ„æºå¤„ç†">é™æ€èµ„æºå¤„ç†</h3>
<pre><code class="language-xml">&lt;!-- é’ˆå¯¹é™æ€èµ„æºçš„å¤„ç† --&gt;
    &lt;!-- http://localhost:8080/static/css/index.css --&gt;
&lt;mvc:resources mapping=&quot;/static/**&quot; location=&quot;/static/&quot; /&gt;

</code></pre>
<h3 id="é‡å®šå‘å’Œè½¬å‘">é‡å®šå‘å’Œè½¬å‘</h3>
<h4 id="åœ¨servletå®ç°é‡å®šå‘å’Œè½¬å‘">åœ¨Servletå®ç°é‡å®šå‘å’Œè½¬å‘ï¼š</h4>
<p>é‡å®šå‘ï¼šresponse.sendRedirect(&quot;xxx.jsp&quot;);</p>
<p>è½¬å‘ï¼š request.getRequestDispatcher(&quot;xxx.jsp&quot;).forward(request, response);</p>
<h4 id="åœ¨springmvcä¸­">åœ¨SpringMVCä¸­</h4>
<h5 id="è¯·æ±‚è½¬å‘æœ‰ä¸‰ç§æ–¹å¼">è¯·æ±‚è½¬å‘æœ‰ä¸‰ç§æ–¹å¼</h5>
<ul>
<li>åœ¨Handleræ–¹æ³•ä¸­ç›´æ¥è¿”å›é€»è¾‘è§†å›¾åç§°</li>
<li>åœ¨Handleræ–¹æ³•ä¸­è¿”å›&quot;forward:è·¯å¾„&quot;</li>
<li>åœ¨Handleræ–¹æ³•ä¸­è¿”å›InternalResourceViewå¯¹è±¡</li>
</ul>
<blockquote>
<p>å…¶ä¸­ç¬¬äºŒç§å’Œç¬¬ä¸‰ç§ä½œç”¨ä¸€æ ·ï¼Œ éƒ½æ˜¯å°†è·¯å¾„ç”¨è¯·æ±‚è½¬å‘çš„æ–¹å¼è·³è½¬ï¼Œè¿”å›çš„è·¯å¾„æ—¶ä¸ç»è¿‡è§†å›¾è§£æå™¨å¤„ç†çš„ï¼›è€Œç¬¬ä¸€ç§è™½ç„¶ä¹Ÿæ˜¯é€šè¿‡è¯·æ±‚è½¬å‘æ–¹å¼è·³è½¬ï¼Œä½†æ˜¯è¿”å›å€¼ä¼šä½œä¸ºé€»è¾‘è§†å›¾åç§°ï¼Œç»è¿‡è§†å›¾è§£æå™¨å¤„ç†åï¼Œæ‰æ¸²æŸ“ã€‚</p>
</blockquote>
<h5 id="é‡å®šå‘æœ‰ä¸¤ç§æ–¹å¼">é‡å®šå‘æœ‰ä¸¤ç§æ–¹å¼</h5>
<ul>
<li>åœ¨Handleræ–¹æ³•ä¸­è¿”å›&quot;redirect:è·¯å¾„&quot;</li>
<li>åœ¨Handleræ–¹æ³•ä¸­è¿”å›RedirectViewå¯¹è±¡</li>
</ul>
<blockquote>
<p>è¿™ä¸¤ç§æ–¹æ³•æ•ˆæœä¸€æ ·ã€‚ æ³¨æ„ä½¿ç”¨é‡å®šå‘çš„æ–¹å¼è·³è½¬é¡µé¢ï¼ŒModelä¸­çš„æ•°æ®å°±æ— æ³•å¸¦åˆ°é¡µé¢äº†ï¼ˆå› ä¸ºModelåº•å±‚ä¹Ÿæ˜¯ç”¨è¯·æ±‚ä½œç”¨åŸŸæ¥ä¼ é€’å‚æ•°çš„ï¼‰ã€‚</p>
</blockquote>
<h3 id="restfullæœåŠ¡æ¥å£å¼€å‘">RESTFullæœåŠ¡æ¥å£å¼€å‘</h3>
<p>SpringMVCç»™æˆ‘ä»¬æä¾›äº†ä¸€ç³»åˆ—çš„æ³¨è§£ç”¨äºæ”¯æŒRESTFullé£æ ¼çš„æœåŠ¡å¼€å‘</p>
<h4 id="å¸¸ç”¨restfullæ³¨è§£">å¸¸ç”¨RESTFullæ³¨è§£</h4>
<ul>
<li>
<p><code>@RestController</code></p>
<p>è¯¥æ³¨è§£æœ¬èº«æ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£ï¼Œç”±<code>@Controller</code>å’Œ<code>@ResponseBody</code>ä¸¤ä¸ªæ³¨è§£ç»„æˆï¼Œæ‰€ä»¥æ‹¥æœ‰è¿™ä¸¤ä¸ªæ³¨è§£çš„ä½œç”¨ã€‚ åœ¨ç±»ä¸Šå£°æ˜åï¼Œè¯¥ç±»ä¼šå˜æˆä¸€ä¸ªControllerç±»ï¼ŒåŒæ—¶ï¼Œæ–¹æ³•çš„è¿”å›å€¼ä¼šä½œä¸ºå“åº”ä½“ç»è¿‡æ¶ˆæ¯è½¬æ¢å™¨ç›´æ¥å“åº”ç»™å®¢æˆ·ç«¯ï¼Œè€Œä¸ä¼šå°†å…¶ä½œä¸ºè§†å›¾æ¸²æŸ“ã€‚</p>
<pre><code class="language-java">@RestController // è¿™ä¸ªæ³¨è§£å…¶å®æ˜¯ç»„åˆäº†ä¸‹é¢ä¸¤ä¸ªæ³¨è§£çš„ä½œç”¨
//@Controller
//@ResponseBody
public class UserRestController {

}

</code></pre>
</li>
<li>
<p><code>@GetMapping</code> :</p>
<p>ä½œç”¨ï¼š ç”³æ˜å½“å‰handleræ–¹æ³•åªåŒ¹é…GETè¯·æ±‚</p>
<p>ä½¿ç”¨ç¤ºä¾‹</p>
<pre><code class="language-java">@GetMapping(&quot;/{id}&quot;)
public User getUserById(@PathVariable Integer id) {
    return userService.findById(id);
}

</code></pre>
</li>
<li>
<p><code>@PostMapping</code>: ç”³æ˜å½“å‰handleræ–¹æ³•åªåŒ¹é…POSTè¯·æ±‚</p>
</li>
<li>
<p><code>@DeleteMapping</code>: ç”³æ˜å½“å‰handleræ–¹æ³•åªåŒ¹é…DELETEè¯·æ±‚</p>
</li>
<li>
<p><code>@PutMapping</code>: ç”³æ˜å½“å‰handleræ–¹æ³•åªåŒ¹é…PUTè¯·æ±‚</p>
</li>
</ul>
<blockquote>
<p>ä¸Šé¢å››ä¸ªæ³¨è§£åˆ†åˆ«å¯¹åº”HTTPçš„ä¸€ç§è¯·æ±‚æ–¹æ³•ï¼Œä½¿ç”¨æ–¹æ³•ç±»ä¼¼ã€‚</p>
</blockquote>
<p>ä¸Šé¢å››ä¸ªæ³¨è§£å…¶å®æ˜¯ä¸€ç§å¿«æ·æ³¨è§£ï¼Œ ç­‰æ•ˆäºä½¿ç”¨ä¸‹é¢ä»£ç ï¼š</p>
<pre><code class="language-java">@RequestMapping(value = &quot;/user&quot;, method = RequestMethod.GET)
@RequestMapping(value = &quot;/user&quot;, method = RequestMethod.POST)
@RequestMapping(value = &quot;/user&quot;, method = RequestMethod.PUT)
@RequestMapping(value = &quot;/user&quot;, method = RequestMethod.DELETE)

</code></pre>
<ul>
<li>@PathVariable: è·å–è¯·æ±‚åœ°å€ä¸­çš„å˜é‡ï¼Œæ³¨å…¥åˆ°æ–¹æ³•å‚æ•°ä¸­</li>
</ul>
<h4 id="è¿”å›jsonæ ¼å¼çš„æ•°æ®-æ¶ˆæ¯è½¬æ¢å™¨">è¿”å›JSONæ ¼å¼çš„æ•°æ® â€”â€” æ¶ˆæ¯è½¬æ¢å™¨</h4>
<h5 id="æ¶ˆæ¯è½¬æ¢å™¨æ˜¯ä»€ä¹ˆ">æ¶ˆæ¯è½¬æ¢å™¨æ˜¯ä»€ä¹ˆ</h5>
<p>ä¹‹å‰æˆ‘ä»¬åœ¨å†™æ™®é€šControlleræ—¶ï¼Œhandleræ–¹æ³•çš„è¿”å›å€¼è¦æ˜¯å°±æ˜¯ä¸€ä¸ªStringï¼ˆé€»è¾‘è§†å›¾åï¼‰ï¼Œè¦ä¹ˆå°±æ˜¯ä¸€ä¸ªModelAndViewã€Viewå¯¹è±¡ã€‚</p>
<p>è€Œæˆ‘ä»¬ä½¿ç”¨äº†RestControllerä¹‹åï¼Œæ–¹æ³•çš„è¿”å›å€¼å·²ç»ä¸ä¼šè¢«ä½œä¸ºè§†å›¾å»æ¸²æŸ“äº†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬çš„æ–¹æ³•å…¶å®å¯ä»¥è¿”å›ä»»æ„ç±»å‹çš„æ•°æ®ã€‚è¿™äº›æ•°æ®ä¼šç›´æ¥é€šè¿‡å“åº”ä½“ä»¥æµçš„æ–¹å¼è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“Javaä¸­çš„å¯¹è±¡æ˜¯ä¸èƒ½ç›´æ¥ç”¨æµçš„æ–¹å¼è¯»å–çš„ï¼Œéœ€è¦åºåˆ—åŒ–ã€‚æ¯”å¦‚æˆ‘ä»¬çš„handleræ–¹æ³•è¿”å›äº†ä¸€ä¸ªUserç±»å‹ï¼ŒSpringMVCå°±ä¸çŸ¥é“å¦‚æœå°†è¿™ä¸ªç±»å‹è¿”å›ç»™å®¢æˆ·ç«¯äº†ã€‚è¿™æ—¶å°±éœ€è¦æˆ‘ä»¬é€šè¿‡é…ç½®æ¶ˆæ¯è½¬æ¢å™¨æ¥å®Œæˆè¿™ç§ç±»å‹å¯¹è±¡çš„è¿”å›å¤„ç†ã€‚ è€Œåœ¨RESTFullæœåŠ¡ä¸­ï¼Œå¯¹è±¡ç»å¤§éƒ¨åˆ†ä¼ é€’æ–¹å¼å°±æ˜¯é€šè¿‡JSONæ ¼å¼ã€‚</p>
<h5 id="å¦‚ä½•é…ç½®ä¸€ä¸ªè½¬æ¢jsonæ ¼å¼çš„æ¶ˆæ¯è½¬æ¢å™¨">å¦‚ä½•é…ç½®ä¸€ä¸ªè½¬æ¢JSONæ ¼å¼çš„æ¶ˆæ¯è½¬æ¢å™¨</h5>
<ul>
<li>
<p>ä½¿ç”¨SpringMVCé»˜è®¤çš„Jacksonåº“</p>
<ol>
<li>
<p>å¼•å…¥ä¾èµ–</p>
<pre><code class="language-xml">&lt;!-- jacksonä¾èµ–ï¼Œç”¨äºå°†handleræ–¹æ³•è¿”å›çš„å¯¹è±¡ç›´æ¥è½¬æ¢æˆJSONæ•°æ® --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
    &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
    &lt;version&gt;2.9.7&lt;/version&gt;
&lt;/dependency&gt;

</code></pre>
</li>
<li>
<p>å¼€å¯mvcæ³¨è§£æ”¯æŒ</p>
<pre><code class="language-xml">&lt;mvc:annotation-driven /&gt;

</code></pre>
</li>
<li>
<p>å®šä¹‰Controllerç±»</p>
<pre><code class="language-java">@RestController
@RequestMapping(&quot;/user&quot;)
public class UserRestController {
    
    @GetMapping(&quot;/{id}&quot;)
    public User getUserById(Integer id) {
        return userService.findById(id);
    }
    
}

</code></pre>
</li>
</ol>
<blockquote>
<p>Jacksonæ˜¯SpringMVCé»˜è®¤çš„JSONæ ¼å¼æ¶ˆæ¯è½¬æ¢å™¨ï¼Œ æ‰€ä»¥åœ¨ä¸é…ç½®é¢å¤–è½¬jsonå‚æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åªå¼•å…¥jacksonä¾èµ–ï¼Œå†å¼€å¯mvcç›´æ¥æ”¯æŒå°±å¯ä»¥äº†ã€‚è€Œç¬¬ä¸‰æ–¹çš„è½¬æ¢åº“å¦‚FastJSONå°±å¿…é¡»æ˜¾ç¤ºé…ç½®MessageConverter</p>
</blockquote>
</li>
<li>
<p>ä½¿ç”¨é˜¿é‡Œå·´å·´çš„FastJSONåº“</p>
<ol>
<li>
<p>å¼•å…¥ä¾èµ–</p>
<pre><code class="language-xml">&lt;dependency&gt;
     &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
     &lt;artifactId&gt;fastjson&lt;/artifactId&gt;
     &lt;version&gt;1.2.57&lt;/version&gt;
&lt;/dependency&gt;

</code></pre>
</li>
<li>
<p>é…ç½®MessageConverter</p>
<pre><code class="language-xml">&lt;mvc:annotation-driven&gt;
    &lt;mvc:message-converters&gt;
        &lt;bean class=&quot;com.alibaba.fastjson.support.spring.FastJsonHttpMessageConverter&quot;&gt;
            &lt;property name=&quot;defaultCharset&quot; value=&quot;UTF-8&quot; /&gt;
            &lt;property name=&quot;fastJsonConfig&quot;&gt;
                &lt;!-- è®¾ç½®è½¬æ¢JSONçš„å‚æ•° --&gt;
                &lt;bean class=&quot;com.alibaba.fastjson.support.config.FastJsonConfig&quot;&gt;
                    &lt;property name=&quot;dateFormat&quot; value=&quot;yyyy-MM-dd HH:mm:ss&quot; /&gt;
                &lt;/bean&gt;
            &lt;/property&gt;
            &lt;property name=&quot;supportedMediaTypes&quot;&gt;
            &lt;!-- æŒ‡å®šè½¬æ¢å®ŒJSONåè¿”å›çš„å“åº”å¤´å’Œç¼–ç ï¼Œæ·»åŠ text/htmlæ˜¯ä¸ºäº†å¤„ç†åœ¨IEä¸‹application/jsonä¼šå¼¹å‡ºä¸‹è½½æ¡†é—®é¢˜ --&gt;
                &lt;list&gt;
                    &lt;!--&lt;value&gt;text/html;charset=UTF-8&lt;/value&gt;--&gt;                
                    &lt;value&gt;application/json;charset=UTF-8&lt;/value&gt;
                &lt;/list&gt;
            &lt;/property&gt;
        &lt;/bean&gt;
    &lt;/mvc:message-converters&gt;
&lt;/mvc:annotation-driven&gt;

</code></pre>
</li>
<li>
<p>å®šä¹‰Controllerç±»</p>
<pre><code class="language-java">@RestController
@RequestMapping(&quot;/user&quot;)
public class UserRestController {
    
    @GetMapping(&quot;/{id}&quot;)
    public User getUserById(Integer id) {
        return userService.findById(id);
    }
    
}

</code></pre>
</li>
</ol>
</li>
</ul>
<h4 id="é€šè¿‡ç½‘é¡µæ¨¡æ‹Ÿrestfullè¯·æ±‚">é€šè¿‡ç½‘é¡µæ¨¡æ‹ŸRESTFullè¯·æ±‚</h4>
<p>é€šè¿‡SpringMVCç»™æˆ‘ä»¬æä¾›çš„ä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¡¨å•æ¨¡æ‹Ÿå„ç§RESTFullçš„è¯·æ±‚ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p>åœ¨web.xmlä¸­æ·»åŠ è¿‡æ»¤å™¨</p>
<pre><code class="language-xml">&lt;filter&gt;
    &lt;filter-name&gt;httpMethodFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.springframework.web.filter.HiddenHttpMethodFilter&lt;/filter-class&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
    &lt;filter-name&gt;httpMethodFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;

</code></pre>
</li>
<li>
<p>åœ¨è¡¨å•ä¸­æ·»åŠ nameä¸º_methodçš„hiddenåŸŸï¼Œå¹¶å°†è¡¨å•çš„methodè®¾ç½®ä¸ºpost</p>
<pre><code class="language-html">&lt;!-- ä½¿ç”¨è¡¨å•æ¨¡æ‹Ÿå‘èµ·ä¸€ä¸ªDELETEè¯·æ±‚ï¼Œåˆ é™¤userè¡¨ä¸­idä¸º57çš„æ•°æ® --&gt;
&lt;form action=&quot;/user/57&quot; method=&quot;post&quot;&gt;
    &lt;input type=&quot;hidden&quot; name=&quot;_method&quot; value=&quot;delete&quot; /&gt;
    &lt;input type=&quot;number&quot; name=&quot;id&quot; /&gt;
    &lt;input type=&quot;text&quot; name=&quot;username&quot; /&gt;
    &lt;input type=&quot;submit&quot; /&gt;
&lt;/form&gt;

</code></pre>
</li>
</ol>
<blockquote>
<p>ç”±äºRESTFullè¯·æ±‚é€šå¸¸å‘ç”Ÿåœ¨æœåŠ¡äºæœåŠ¡ä¹‹é—´çš„è°ƒç”¨ï¼Œæ‰€ä»¥æœ‰äº›è¯·æ±‚ç”¨æµè§ˆå™¨ä¸å¤ªå¥½æ¨¡æ‹Ÿï¼Œå»ºè®®ä½¿ç”¨ä¸“ä¸šçš„ç½‘ç»œæµ‹è¯•å·¥å…·postmanæ¥è¿›è¡Œæµ‹è¯•ã€‚</p>
</blockquote>
<h4 id="resttemplateå·¥å…·ç±»">RestTemplateå·¥å…·ç±»</h4>
<p>SpringMVCå¸®æˆ‘ä»¬å°è£…çš„ä¸€ä¸ªRestè¯·æ±‚å·¥å…·ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªURIåœ°å€å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œå¹¶ä¸”å°†ç»“æœå°è£…æˆä¸€ä¸ªæŒ‡å®šçš„å¯¹è±¡ã€‚</p>
<h3 id="å¤„ç†è¯·æ±‚ä¹±ç ">å¤„ç†è¯·æ±‚ä¹±ç </h3>
<p>SpringMVCç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªä¸“é—¨ç”¨æ¥è§£å†³postè¯·æ±‚ä¹±ç çš„è¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬åªéœ€å°†å…¶é…ç½®åˆ°web.xmlä¸­ï¼Œå°±å¯ä»¥é¿å…postè¯·æ±‚ä¹±ç ï¼Œå…å»äº†æˆ‘ä»¬è‡ªå·±å†™è¿‡æ»¤å™¨çš„éº»çƒ¦</p>
<p>åœ¨web.xmlä¸­</p>
<pre><code class="language-xml">&lt;!-- è§£å†³POSTè¯·æ±‚ä¹±ç  --&gt;
&lt;filter&gt;
    &lt;filter-name&gt;encodingFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
    &lt;init-param&gt;
        &lt;param-name&gt;encoding&lt;/param-name&gt;
        &lt;param-value&gt;UTF-8&lt;/param-value&gt;
    &lt;/init-param&gt;
    &lt;init-param&gt;
        &lt;param-name&gt;forceEncoding&lt;/param-name&gt;
        &lt;param-value&gt;true&lt;/param-value&gt;
    &lt;/init-param&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
    &lt;filter-name&gt;encodingFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;

</code></pre>
<blockquote>
<p>æ³¨æ„ï¼š å¦‚æœé¡¹ç›®ä¸­é…ç½®äº†å¤šä¸ªè¿‡æ»¤å™¨ï¼Œå»ºè®®å°†æ­¤è¿‡æ»¤å™¨æ”¾åˆ°æ‰€æœ‰è¿‡æ»¤å™¨çš„æœ€ä¸Šé¢ã€‚</p>
</blockquote>
<h3 id="åœ¨springmvcæ–¹æ³•ä¸­æ”¯æŒçš„å‚æ•°">åœ¨SpringMVCæ–¹æ³•ä¸­æ”¯æŒçš„å‚æ•°</h3>
<p>SpringMVCçš„handleræ–¹æ³•ä¸­æ”¯æŒè¯¸å¦‚å¾ˆå¤šç‰¹æ®Šç±»å‹çš„å‚æ•°ï¼Œå¸¸ç”¨çš„æœ‰</p>
<h5 id="æ³¨å…¥åŸç”Ÿservletå¯¹è±¡">æ³¨å…¥åŸç”ŸServletå¯¹è±¡</h5>
<ul>
<li>javax.servlet.ServletRequest</li>
<li>javax.servlet.ServletResponse</li>
<li>javax.serlvet.http.HttpSession</li>
</ul>
<h5 id="ä»¥æµçš„æ–¹å¼è¯»å–è¯·æ±‚ä½“-ä»¥æµçš„æ–¹å¼å“åº”åˆ°å®¢æˆ·ç«¯">ä»¥æµçš„æ–¹å¼è¯»å–è¯·æ±‚ä½“ã€ä»¥æµçš„æ–¹å¼å“åº”åˆ°å®¢æˆ·ç«¯</h5>
<ul>
<li><s>java.io.InputStreamã€java.io.Reader</s></li>
<li><s>java.io.OutputStreamã€java.io.Writer</s></li>
</ul>
<h5 id="è¯»å–è¯·æ±‚ä½“å’Œè¯·æ±‚å¤´æ•°æ®">è¯»å–è¯·æ±‚ä½“å’Œè¯·æ±‚å¤´æ•°æ®</h5>
<ul>
<li>HttpEntity</li>
</ul>
<h5 id="å‘é¡µé¢ä¼ å‚">å‘é¡µé¢ä¼ å‚</h5>
<ul>
<li>java.util.Mapï¼Œorg.springframework.ui.Modelã€org.springframework.ui.ModelMap</li>
</ul>
<!-- SpringMVC ç¬¬ä¸‰å¤© -->
<h3 id="æ–‡ä»¶ä¸Šä¼ ">æ–‡ä»¶ä¸Šä¼ </h3>
<h4 id="è¯´æ˜">è¯´æ˜</h4>
<p>åœ¨Javaä¸­ï¼Œä¸»æµçš„æ–‡ä»¶ä¸Šä¼ æ–¹å¼æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯é€šç”¨æ–‡ä»¶ä¸Šä¼ (commons-fileupload)å’ŒServlet3.0æ–¹å¼çš„æ–‡ä»¶ä¸Šä¼ ã€‚SpringMVCåˆ†åˆ«å¯¹ç€ä¸¤ç§æ–¹å¼éƒ½åšäº†æ”¯æŒã€‚</p>
<ul>
<li>CommonsMultipartResolver</li>
<li>StandardServletMultipartResolver</li>
</ul>
<blockquote>
<p>é™¤æ­¤ä¹‹å¤–SpringMVCå¯¹æ–‡ä»¶ä¸Šä¼ çš„æ¥å£åšäº†ç»Ÿä¸€çš„å°è£…ï¼Œä½¿ç”¨<code>MultipartFile</code>æ¥å£ä»£æ›¿äº†é€šç”¨ä¸Šä¼ ä¸­çš„<code>FileItem</code>å’ŒServlet3.0ä¸­çš„<code>Part</code>ï¼Œä½¿å¾—å¼€å‘äººå‘˜åœ¨ä¸šåŠ¡ä»£ç ä¸­å¯ä»¥ä½¿ç”¨ç»Ÿä¸€çš„æ¥å£å¤„ç†ï¼Œè€Œä¸ç”¨ç®¡åº•å±‚ç”¨çš„æ˜¯å“ªç§æ–‡ä»¶ä¸Šä¼ å®ç°æ–¹å¼ã€‚</p>
</blockquote>
<h4 id="åŸºäºapache-fileuploadé€šç”¨æ–‡ä»¶ä¸Šä¼ åŒ…">åŸºäºApache Fileuploadé€šç”¨æ–‡ä»¶ä¸Šä¼ åŒ…</h4>
<ol>
<li>
<p>æ·»åŠ ä¾èµ–</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;commons-fileupload&lt;/groupId&gt;
    &lt;artifactId&gt;commons-fileupload&lt;/artifactId&gt;
    &lt;version&gt;1.4&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;commons-io&lt;/groupId&gt;
    &lt;artifactId&gt;commons-io&lt;/artifactId&gt;
    &lt;version&gt;2.6&lt;/version&gt;
&lt;/dependency&gt;

</code></pre>
</li>
<li>
<p>åœ¨SpringMVCé…ç½®æ–‡ä»¶ä¸­æ·»åŠ MultipartResolveræ–‡ä»¶ä¸Šä¼ è§£æå™¨</p>
<pre><code class="language-xml">&lt;!-- é…ç½®åŸºäºapache fileuploadçš„é€šç”¨æ–‡ä»¶ä¸Šä¼ å™¨ï¼ˆæ³¨æ„ï¼šidå±æ€§ä¸å¯çœç•¥ï¼‰ --&gt;
&lt;bean id=&quot;multipartResolver&quot; class=&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;&gt;
    &lt;!-- æŒ‡å®šæ–‡ä»¶ä¸Šä¼ ç¼–ç  --&gt;
    &lt;property name=&quot;defaultEncoding&quot; value=&quot;UTF-8&quot; /&gt;
&lt;/bean&gt;

</code></pre>
</li>
<li>
<p>åœ¨Controllerä¸­ç¼–å†™æ–‡ä»¶ä¸Šä¼ é€»è¾‘ä»£ç </p>
<pre><code class="language-java">@RequestMapping(&quot;/upload&quot;)
public String upload(@RequestParam(&quot;myFile&quot;) MultipartFile file, HttpServletRequest req, Model model) {
    try {
        // ä½¿ç”¨SpringMVCç»™æˆ‘ä»¬æä¾›çš„å·¥å…·ç±»è·å–é¡¹ç›®ä¸­uploadæ–‡ä»¶å¤¹åœ¨ç¡¬ç›˜ä¸Šçš„ç»å¯¹è·¯å¾„
        String uploadPath = WebUtils.getRealPath(req.getServletContext(), &quot;/upload/&quot;);
        // å°†ä¸Šä¼ çš„æ–‡ä»¶å†™åˆ°ä¸Šä¼ ç›®å½•
        file.transferTo(new File(uploadPath+file.getOriginalFilename()));
    } catch (IOException e) {
        e.printStackTrace();
    }
}

</code></pre>
</li>
</ol>
<h4 id="åŸºäºservlet30æ ‡å‡†apiæ–‡ä»¶ä¸Šä¼ ">åŸºäºServlet3.0æ ‡å‡†APIæ–‡ä»¶ä¸Šä¼ </h4>
<ol>
<li>
<p>å¼€å¯Servletæ–‡ä»¶ä¸Šä¼ æ”¯æŒ</p>
<p>web.xml</p>
<pre><code class="language-xml">&lt;servlet&gt;
    &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
    &lt;!-- å¼€å¯Servletæ–‡ä»¶ä¸Šä¼ æ”¯æŒ --&gt;
    &lt;multipart-config /&gt;
&lt;/servlet&gt;
&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;

</code></pre>
</li>
<li>
<p>åœ¨SpringMVCä¸­é…ç½®MultipartResolver</p>
<pre><code class="language-xml">&lt;!-- é…ç½®åŸºäºServlet3.0æ–‡ä»¶ä¸Šä¼ å™¨ï¼ˆæ³¨æ„ï¼šidå±æ€§ä¸å¯çœç•¥ï¼‰ --&gt;
&lt;bean id=&quot;multipartResolver&quot; class=&quot;org.springframework.web.multipart.support.StandardServletMultipartResolver&quot; /&gt;

</code></pre>
</li>
<li>
<p>åœ¨Controllerä¸­ç¼–å†™æ–‡ä»¶ä¸Šä¼ é€»è¾‘ä»£ç </p>
<blockquote>
<p>å®ç°æ–¹å¼åŒé€šç”¨ä¸Šä¼ ä»£ç ä¸€æ ·ã€‚</p>
</blockquote>
</li>
</ol>
<h4 id="æ–‡ä»¶åä¸Šä¼ ä¹±ç é—®é¢˜">æ–‡ä»¶åä¸Šä¼ ä¹±ç é—®é¢˜</h4>
<ul>
<li>
<p>ä½¿ç”¨é€šç”¨ä¸Šä¼ æ–¹å¼çš„è§£å†³æ–¹æ³•</p>
<p>åœ¨é…ç½®çš„CommonsMultipartResolver beanä¸­æ³¨å…¥å±æ€§</p>
<pre><code class="language-xml">&lt;!-- é…ç½®åŸºäºapache fileuploadçš„é€šç”¨æ–‡ä»¶ä¸Šä¼ å™¨ï¼ˆæ³¨æ„ï¼šidå±æ€§ä¸å¯çœç•¥ï¼‰ --&gt;
&lt;bean id=&quot;multipartResolver&quot; class=&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;&gt;
    &lt;!-- æŒ‡å®šæ–‡ä»¶ä¸Šä¼ ç¼–ç  --&gt;
    &lt;property name=&quot;defaultEncoding&quot; value=&quot;UTF-8&quot; /&gt;
&lt;/bean&gt;

</code></pre>
</li>
<li>
<p>ä½¿ç”¨Servlet3.0æ ‡å‡†ä¸Šä¼ æ–¹å¼çš„è§£å†³æ–¹æ³•</p>
<p>é€šè¿‡é…ç½®SpringMVCæä¾›çš„ç¼–ç è¿‡æ»¤å™¨è§£å†³</p>
<p>web.xml</p>
<pre><code class="language-xml">&lt;filter&gt;
    &lt;filter-name&gt;characterFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
    &lt;init-param&gt;
        &lt;param-name&gt;encoding&lt;/param-name&gt;
        &lt;param-value&gt;UTF-8&lt;/param-value&gt;
    &lt;/init-param&gt;
    &lt;init-param&gt;
        &lt;param-name&gt;forceEncoding&lt;/param-name&gt;
        &lt;param-value&gt;true&lt;/param-value&gt;
    &lt;/init-param&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
    &lt;filter-name&gt;characterFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;

</code></pre>
<blockquote>
<p>æœ¬è´¨ä¸Šè¿˜æ˜¯è®¾ç½®è¯·æ±‚çš„ç¼–ç  request.setCharacterEncoding(&quot;UTF-8&quot;);</p>
</blockquote>
</li>
</ul>
<h3 id="æ‹¦æˆªå™¨">æ‹¦æˆªå™¨</h3>
<h4 id="æ‹¦æˆªå™¨-vs-è¿‡æ»¤å™¨">æ‹¦æˆªå™¨ VS è¿‡æ»¤å™¨</h4>
<p>è¿‡æ»¤å™¨æ˜¯Servletè§„èŒƒä¸­æä¾›çš„ä¸€é¡¹æŠ€æœ¯ã€‚ä¸ä¾èµ–äºä»»ä½•ç¬¬ä¸‰æ–¹æ¡†æ¶ã€‚å®ƒçš„ä½œç”¨ä¸»è¦ç”¨æ¥åšä¸¤ä»¶äº‹ï¼š åŠ å·¥è¯·æ±‚ã€è¿‡æ»¤è¯·æ±‚ã€‚</p>
<p>æ‹¦æˆªå™¨æ˜¯SpringMVCè‡ªå·±å°è£…çš„ä¸€é¡¹åŸºäºHandleræ‹¦æˆªçš„ç»“æŸã€‚ä¹Ÿå°±æ˜¯è¯´åªæœ‰åœ¨SpringMVCæ¡†æ¶é‡Œé¢æ‰æœ‰æ‹¦æˆªå™¨çš„æ¦‚å¿µã€‚æ‹¦æˆªå™¨æ‹¦æˆªçš„å¯¹è±¡æ˜¯Handlerã€‚å®ƒçš„å…¨ç§°æ˜¯ HandlerInterceptorã€‚</p>
<p>åŠ ä¸Šæ‹¦æˆªå™¨ä»¥åï¼Œè¯·æ±‚å¤„ç†æµç¨‹ï¼š  request -&gt; DispatcherServlet -&gt; HandlerMapping -&gt; HandlerExecutionChain(åŒ…å«äº†ç›®æ ‡handlerå’Œè‹¥å¹²ä¸ªæ‹¦æˆªå™¨) -&gt; HandlerAdapter -&gt; å¾ªç¯è°ƒç”¨HandlerExecutionChainå¯¹è±¡ä¸­æ‰€æœ‰æ‹¦æˆªå™¨çš„prehandleræ–¹æ³• -&gt; å¦‚æœpreHandlerè¿”å›falseï¼Œé‚£ä¹ˆhandlerå°†ä¸ä¼šè¢«è°ƒç”¨ã€‚åä¹‹ï¼Œæ‰ä¼šæ­£å¸¸è°ƒç”¨ã€‚</p>
<h4 id="å¦‚ä½•ä½¿ç”¨æ‹¦æˆªå™¨">å¦‚ä½•ä½¿ç”¨æ‹¦æˆªå™¨</h4>
<h5 id="å®šä¹‰æ‹¦æˆªå™¨ç±»">å®šä¹‰æ‹¦æˆªå™¨ç±»</h5>
<p>æ–°å»ºä¸€ä¸ªç±»å®ç°HandlerInterceptoræ¥å£</p>
<pre><code class="language-java">/**
 * å®šä¹‰æ‹¦æˆªå™¨æ­¥éª¤ï¼š
 *      1. å®šä¹‰ä¸€ä¸ªæ™®é€šç±»ï¼Œå®ç°HandlerInterceptoræ¥å£
 *      2. æŒ‰éœ€å®ç°æ¥å£ä¸­çš„æ–¹æ³•
 *      3. åœ¨SpringMVCé…ç½®æ–‡ä»¶ä¸­é€šè¿‡&lt;mvc:interceptors&gt;&lt;/mvc:interceptors&gt;é…ç½®æ‹¦æˆªå™¨
 */
public class NotAllowedInterceptor implements HandlerInterceptor {

    /**
     * æ­¤å›è°ƒæ–¹æ³•åœ¨æ‰§è¡ŒHandlerä¹‹å‰è¢«è°ƒç”¨
     * @param request
     * @param response
     * @param handler
     * @return
     * @throws Exception
     */
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {
        System.out.println(&quot;è¿›å…¥NotAllowedInterceptor, å‡¡æ˜¯æˆ‘èƒ½æ‹¦æˆªåˆ°çš„è¯·æ±‚ï¼Œä¸€å¾‹ä¸å‡†é€šè¿‡!&quot;);
        return false;
    }

    /**
     * æ­¤å›è°ƒæ–¹æ³•åœ¨æ‰§è¡ŒHandlerä¹‹åè¢«è°ƒç”¨
     * @param request
     * @param response
     * @param handler
     * @param modelAndView
     * @throws Exception
     */
    @Override
    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception {

    }

    /**
     * æ­¤å›è°ƒæ–¹æ³•åœ¨DispatcherServletæœ€ç»ˆå“åº”ä¹‹å‰è¢«è°ƒç”¨
     * @param request
     * @param response
     * @param handler
     * @param ex
     * @throws Exception
     */
    @Override
    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception {

    }
}

</code></pre>
<h5 id="é…ç½®æ‹¦æˆªå™¨">é…ç½®æ‹¦æˆªå™¨</h5>
<h6 id="å…¨å±€æ‹¦æˆªå™¨">å…¨å±€æ‹¦æˆªå™¨</h6>
<pre><code class="language-xml">&lt;mvc:interceptors&gt;
    &lt;!-- è¿™ç§æ–¹å¼é…ç½®çš„æ‹¦æˆªå™¨ä¼šæ‹¦æˆªæ‰€æœ‰è¯·æ±‚ --&gt;
    &lt;bean class=&quot;com.lanou3g.springmvc.interceptor.NotAllowedInterceptor&quot; /&gt;
&lt;/mvc:interceptors&gt;

</code></pre>
<h6 id="æ‹¦æˆªæŒ‡å®šè¯·æ±‚çš„æ‹¦æˆªå™¨">æ‹¦æˆªæŒ‡å®šè¯·æ±‚çš„æ‹¦æˆªå™¨</h6>
<pre><code class="language-xml">&lt;mvc:interceptors&gt;
    &lt;mvc:interceptor&gt;
        &lt;!-- æ‹¦æˆªçš„è¯·æ±‚ --&gt;
        &lt;mvc:mapping path=&quot;/admin/**&quot; /&gt;
        &lt;!-- ä¸æ‹¦æˆªçš„è¯·æ±‚ --&gt;
        &lt;mvc:exclude-mapping path=&quot;/intercepor/**&quot;/&gt;
        &lt;!-- é…ç½®æˆ‘ä»¬å®šä¹‰çš„å®ç°äº†HandlerInterceptoræ¥å£çš„ç±» --&gt;
        &lt;bean class=&quot;com.lanou3g.springmvc.interceptor.NotAllowedInterceptor&quot; /&gt;
    &lt;/mvc:interceptor&gt;
&lt;/mvc:interceptors&gt;

</code></pre>
<h3 id="ssmæ•´åˆ">SSMæ•´åˆ</h3>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Spring]]></title>
        <id>https://zjt-zjt.github.io/post/spring</id>
        <link href="https://zjt-zjt.github.io/post/spring">
        </link>
        <updated>2018-09-04T11:00:31.000Z</updated>
        <content type="html"><![CDATA[<!-- more -->
<h2 id="iocå®¹å™¨æ¦‚å¿µ">IOCå®¹å™¨æ¦‚å¿µ</h2>
<p>IOCå…¶å®å°±æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å®¹å™¨ã€‚å…¨ç§°Inversion Of Control æ§åˆ¶åè½¬ï¼Œæ ¸å¿ƒçš„ä½œç”¨å°±æ˜¯å°†åŸæ¥ç”±å¼€å‘äººå‘˜æ¥æ§åˆ¶çš„å¯¹è±¡ç®¡ç†æ“ä½œäº¤ç”±Springæ¥ç®¡ç†ã€‚</p>
<p>SpringIOCä¸ä»…å¸®æˆ‘ä»¬ç®¡ç†äº†å¯¹è±¡çš„åˆ›å»ºï¼Œè¿˜åŒ…æ‹¬ç»™å¯¹è±¡å¢åŠ äº†ç”Ÿå‘½å‘¨æœŸè¡Œä¸ºã€ä½œç”¨åŸŸ(å•ä¾‹ã€éå•ä¾‹)ã€æ‡’åŠ è½½ã€‚ é…åˆSpringçš„DIï¼Œ æ›´èƒ½æ–¹ä¾¿çš„è§£å†³å¯¹è±¡å±æ€§å€¼æ³¨å…¥ã€å¯¹è±¡ä¹‹é—´çš„ä¾èµ–æ³¨å…¥é—®é¢˜ã€‚</p>
<h2 id="iocå®¹å™¨åˆå§‹åŒ–æ–¹å¼">IOCå®¹å™¨åˆå§‹åŒ–æ–¹å¼</h2>
<h3 id="classpathxmlapplicationcontext">ClassPathXmlApplicationContext</h3>
<p>è¯¥ç±»è´Ÿè´£åŠ è½½ç±»è·¯å¾„ä¸‹çš„xmlé…ç½®æ–‡ä»¶çš„æ–¹å¼ï¼Œå»åˆå§‹åŒ–IOCå®¹å™¨ä¸Šä¸‹æ–‡ï¼Œå…·ä½“ä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p>ç¼–å†™é…ç½®æ–‡ä»¶</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;
    
    &lt;!-- ä½¿ç”¨beanæ ‡ç­¾å°†å¯¹è±¡é…ç½®åˆ°iocå®¹å™¨ä¸­ --&gt;
    &lt;bean id=&quot;man&quot; class=&quot;com.lanou3g.bean.Man&quot; /&gt;
    &lt;bean id=&quot;apple&quot; class=&quot;com.lanou3g.bean.Food&quot; /&gt;
&lt;/beans&gt;
</code></pre>
</li>
<li>
<p>åŠ è½½é…ç½®æ–‡ä»¶ï¼Œåˆå§‹åŒ–IOCå®¹å™¨</p>
</li>
</ol>
<pre><code class="language-java">   // åŠ è½½å•ä¸ªxmlé…ç½®ï¼Œåˆå§‹åŒ–ä¸Šä¸‹æ–‡
   ClassPathXmlApplicationContext ctx = new ClassPathXmlApplicationContext(&quot;applicationContext1.xml&quot;);
  
   // åŠ è½½å¤šä¸ªxmlé…ç½®ï¼Œåˆå§‹åŒ–ä¸Šä¸‹æ–‡
   ClassPathXmlApplicationContext ctx = new ClassPathXmlApplicationContext(new String[]{&quot;applicationContext1.xml&quot;, &quot;applicationContext2.xml&quot;});
  
   // åŠ è½½å½“å‰è¿è¡Œç±»æ‰€åœ¨çš„ç±»è·¯å¾„ä¸‹æ‰€æœ‰ä»¥applicationå¼€å¤´çš„é…ç½®æ–‡ä»¶
   ClassPathXmlApplicationContext ctx = new ClassPathXmlApplicationContext(&quot;appliction*.xml&quot;);
  
   // åŠ è½½å·¥ç¨‹ä¸­æ‰€æœ‰ç±»è·¯å¾„ä¸‹æ‰€æœ‰ä»¥applicationå¼€å¤´çš„é…ç½®æ–‡ä»¶
   ClassPathXmlApplicationContext ctx = new ClassPathXmlApplicationContext(&quot;classpath*:appliction*.xml&quot;);
  
   // åŠ è½½å·¥ç¨‹ä¸­æ‰€æœ‰ç±»è·¯å¾„ä¸‹æ‰€æœ‰ä»¥applicationæˆ–springå¼€å¤´çš„é…ç½®æ–‡ä»¶
   ClassPathXmlApplicationContext ctx = new ClassPathXmlApplicationContext(new String[]{&quot;classpath*:appliction*.xml&quot;, &quot;classpath*:spring*.xml&quot;});
</code></pre>
<blockquote>
<p>é…ç½®æ–‡ä»¶è·¯å¾„ä¸­å¯ä»¥åŒ…å«é€šé…ç¬¦(*)å’Œå‰ç¼€(classpath*:ï¼Œä»£è¡¨æ‰€æœ‰ç±»è·¯å¾„ï¼ŒåŒ…æ‹¬æºç ç±»è·¯å¾„å’Œå•å…ƒæµ‹è¯•ç±»è·¯å¾„)</p>
</blockquote>
<ol start="3">
<li>
<p>ä»å®¹å™¨ä¸­è·å–å¯¹è±¡</p>
<pre><code class="language-java">// é€šè¿‡xmlä¸­é…ç½®çš„beançš„idæˆ–nameå±æ€§çš„å€¼è·å–bean, è¿”å›çš„ç±»å‹æ˜¯Objectï¼Œéœ€è¦å¼ºè½¬æˆå¯¹è±¡çœŸæ­£çš„ç±»å‹
Man man = (Man) cxt.getBean(&quot;man&quot;); 
// é€šè¿‡beançš„åç§°è·å–beançš„åŒæ—¶ï¼ŒæŒ‡å®šç±»å‹ 
Man man1 = cxt.getBean(&quot;man&quot;,Man.class); 
// é€šè¿‡ç±»å‹ä»å®¹å™¨ä¸­è·å–beanï¼Œå¦‚æœå®¹å™¨ä¸­è¯¥ç±»å‹çš„beanæœ‰å¤šäºä¸€ä¸ªï¼Œåˆ™ä¼šæŠ¥é”™
Man man2 = cxt.getBean(Man.class); 

// è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•
man.eat();
man.play();
</code></pre>
</li>
</ol>
<h3 id="annotationconfigapplicationcontext">AnnotationConfigApplicationContext</h3>
<p>åŠ è½½é€šè¿‡Javaæ³¨è§£æ–¹å¼é…ç½®çš„Beanä¸Šä¸‹æ–‡ã€‚å…·ä½“ä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p>å®šä¹‰é…ç½®ç±»</p>
<pre><code class="language-java">@Configuration	//ä»£è¡¨è¯¥ç±»æ˜¯ä¸€ä¸ªbeançš„é…ç½®ç±»ï¼Œç±»ä¼¼äºxmlé…ç½®ä¸­çš„&lt;beans&gt;æ ‡ç­¾
public class MyConfiguration {

}
</code></pre>
<ol>
<li>
<p>å¼€å¯æ³¨è§£æ”¯æŒï¼Œé…ç½®æ‰«æåŒ…è·¯å¾„</p>
<p>å¦‚æœæ˜¯é€šè¿‡ClassPathXmlApplicationContextåˆå§‹åŒ–çš„ä¸Šä¸‹æ–‡ï¼Œåˆ™åœ¨xmlä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p>
<pre><code class="language-xml">&lt;!-- æ·»åŠ contextå‘½åç©ºé—´ --&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance	xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;

&lt;!-- ä¸‹é¢ä¸¤ä¸ªé…ç½®ç”¨äºxmlå’Œæ³¨è§£é…ç½®æ··åˆä½¿ç”¨æ—¶ï¼Œå¼€å¯æ³¨è§£æ‰«ææ”¯æŒï¼Œå¹¶æŒ‡å®šæ‰«æçš„åŒ…è·¯å¾„ --&gt;
&lt;!-- å¦‚æœæŒ‡å®šäº†æ‰«æåŒ…è·¯å¾„ï¼Œè¯¥é…ç½®å¯çœç•¥ --&gt;
&lt;context:annotation-config /&gt; 
&lt;context:component-scan base-package=&quot;com.lanou3g.spring&quot; /&gt;
</code></pre>
<p>å¦‚æœæ˜¯é€šè¿‡AnnotationConfigApplicationContextåˆå§‹åŒ–çš„ä¸Šä¸‹æ–‡ï¼Œåˆ™éœ€è¦åœ¨té€šè¿‡<code>@Configuration</code>æ³¨è§£æ ‡æ³¨çš„é…ç½®ç±»ä¸Šæ·»åŠ  @ComponentScansæ³¨è§£ï¼š</p>
<pre><code class="language-java">@Configuration
@ComponentScan(basePackages = &quot;com.lanou.spring&quot;) //æŒ‡å®šæ‰«æåŒ…è·¯å¾„
public class MyConfiguration {

}
</code></pre>
</li>
<li>
<p>é…ç½®Bean</p>
<p>é€šè¿‡æ³¨è§£æ–¹å¼æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥å°†ç±»çš„å¯¹è±¡äº¤ç”±IOCå®¹å™¨ä¸­ç®¡ç†</p>
<ul>
<li>
<p>é€šè¿‡@Componentçš„æ–¹å¼å®šä¹‰</p>
<pre><code class="language-java">@Component
public class King {
}
</code></pre>
<blockquote>
<p>é€‚ç”¨äºæˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ç±»ï¼Œæˆ–è€…æˆ‘ä»¬å¯ä»¥ä¿®æ”¹æºä»£ç çš„ç±»</p>
</blockquote>
</li>
<li>
<p>é€šè¿‡@Beanæ³¨è§£å®šä¹‰</p>
<pre><code class="language-java">public class King {
}


@Configuration
public class MyApplicationContextConf {
    @Bean
    public King king() {
        return new King();
    }
}
</code></pre>
<blockquote>
<p>é€‚ç”¨äºéœ€è¦å°†ç¬¬ä¸‰æ–¹jaråŒ…ä¸­çš„ç±»äº¤ç”±iocç®¡ç†ï¼Œå› ä¸ºæˆ‘ä»¬ä¸èƒ½ä¿®æ”¹jaråŒ…ä¸­çš„ä»£ç ï¼Œæ— æ³•ç»™å…¶æ·»åŠ @Componentæ³¨è§£</p>
</blockquote>
</li>
</ul>
</li>
</ol>
</li>
<li>
<p>åŠ è½½é…ç½®ç±»ï¼Œåˆå§‹åŒ–IOCå®¹å™¨</p>
<pre><code class="language-java">// åŠ è½½å•ä¸ªæ³¨è§£é…ç½®ï¼Œåˆå§‹åŒ–ä¸Šä¸‹æ–‡
AnnotationConfigApplicationContext ctx = new AnnotationConfigApplicationContext(MyConfiguration.class);

// åŠ è½½å¤šä¸ªæ³¨è§£é…ç½®ï¼Œåˆå§‹åŒ–ä¸Šä¸‹æ–‡
AnnotationConfigApplicationContext ctx = new AnnotationConfigApplicationContext(new Class[]{MyConfiguration1.class, MyConfiguration2.class});
</code></pre>
</li>
<li>
<p>ä»å®¹å™¨ä¸­è·å–bean</p>
<pre><code class="language-java">// é€šè¿‡xmlä¸­é…ç½®çš„beançš„idæˆ–nameå±æ€§çš„å€¼è·å–bean, è¿”å›çš„ç±»å‹æ˜¯Objectï¼Œéœ€è¦å¼ºè½¬æˆå¯¹è±¡çœŸæ­£çš„ç±»å‹
Man man = (Man) cxt.getBean(&quot;man&quot;); 
// é€šè¿‡beançš„åç§°è·å–beançš„åŒæ—¶ï¼ŒæŒ‡å®šç±»å‹ 
Man man1 = cxt.getBean(&quot;man&quot;,Man.class); 
// é€šè¿‡ç±»å‹ä»å®¹å™¨ä¸­è·å–beanï¼Œå¦‚æœå®¹å™¨ä¸­è¯¥ç±»å‹çš„beanæœ‰å¤šäºä¸€ä¸ªï¼Œåˆ™ä¼šæŠ¥é”™
Man man2 = cxt.getBean(Man.class); 

// è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•
man.eat();
man.play();
</code></pre>
</li>
</ol>
<h2 id="beanåˆå§‹åŒ–æ–¹å¼">Beanåˆå§‹åŒ–æ–¹å¼</h2>
<h3 id="æ„é€ æ–¹æ³•æ–¹å¼æœ€å¸¸ç”¨">æ„é€ æ–¹æ³•æ–¹å¼ï¼ˆæœ€å¸¸ç”¨ï¼‰</h3>
<pre><code class="language-xml">&lt;bean id=&quot;xx&quot; class=&quot;com.test.StudentDao&quot; /&gt;
</code></pre>
<h3 id="é™æ€å·¥å‚æ–¹æ³•">é™æ€å·¥å‚æ–¹æ³•</h3>
<pre><code class="language-xml">&lt;!-- 
	classï¼šæŒ‡å®šçš„æ˜¯é™æ€å·¥å‚ç±»ï¼Œè€Œä¸æ˜¯å°†è¦åˆ›å»ºçš„å¯¹è±¡ç±»å‹
	factory-method: æŒ‡å®šçš„æ˜¯å·¥å‚ä¸­çš„é™æ€æ–¹æ³• 
--&gt;
&lt;bean id=&quot;xx&quot; class=&quot;com.test.StudentDaoFactory&quot; factory-method=&quot;createDao&quot; /&gt;
</code></pre>
<h3 id="å®ä¾‹å·¥å‚æ–¹æ³•">å®ä¾‹å·¥å‚æ–¹æ³•</h3>
<pre><code class="language-xml">&lt;!-- 
	classï¼šæŒ‡å®šçš„æ˜¯å®ä¾‹å·¥å‚ç±» 
--&gt;
&lt;bean id=&quot;xxFactory&quot; class=&quot;com.test.StudentDaoFactory&quot; /&gt;
&lt;!-- 
	factory-beanï¼šæŒ‡å®šçš„æ˜¯å®ä¾‹å·¥å‚å¯¹è±¡
	factory-method: æŒ‡å®šçš„æ˜¯å·¥å‚ä¸­çš„å®ä¾‹æ–¹æ³• 
--&gt;
&lt;bean id=&quot;xx&quot; factory-bean=&quot;xxFactory&quot; factory-method=&quot;createDao&quot; /&gt;
</code></pre>
<h2 id="beançš„å‘½å">Beançš„å‘½å</h2>
<p>åœ¨XMLä¸­é…ç½®ä¸­å¯ä»¥é€šè¿‡<bean>æ ‡ç­¾ä¸Šçš„idã€nameå±æ€§å€¼ç»™ä¸€ä¸ªbeanå‘½åï¼Œä»¥ä¾¿åœ¨å…¶ä»–åœ°æ–¹å¼•ç”¨ã€‚</p>
<p>idå±æ€§ï¼š beançš„å”¯ä¸€åç§°ï¼Œåªå…è®¸å‡ºç°ä¸€ä¸ªå€¼ã€‚ä¸”åŒä¸€ä¸ªIOCå®¹å™¨ä¸­ä¸å…è®¸å‡ºç°ä¸¤ä¸ªidå€¼ä¸€æ ·çš„beanã€‚</p>
<p>nameå±æ€§ï¼š å’Œidç±»ä¼¼ä¹Ÿæ˜¯ç»™beanå‘½åã€‚ä½†æ˜¯nameå±æ€§çš„å€¼å¯ä»¥æœ‰å¤šä¸ªï¼Œå¤šä¸ªå€¼ä¹‹é—´ä½¿ç”¨è‹±æ–‡é€—å·(,)æˆ–è€…è‹±æ–‡åˆ†å·(;)æˆ–è€…ç©ºæ ¼ç¬¦éš”å¼€</p>
<h2 id="beançš„ä½œç”¨åŸŸ">Beançš„ä½œç”¨åŸŸ</h2>
<ul>
<li>
<p>prototype</p>
<p>åœ¨SpringIOCä¸­prototype scopeçš„æ„æ€æŒ‡çš„æ˜¯éå•ä¾‹ï¼Œå°±æ˜¯æ¯æ¬¡ä½¿ç”¨è¯¥beançš„æ—¶å€™éƒ½ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://docs.spring.io/spring/docs/5.2.0.RELEASE/spring-framework-reference/images/prototype.png" alt="åŸå‹ä½œç”¨åŸŸç¤ºæ„å›¾"></figure>
</li>
<li>
<p>singleton(é»˜è®¤)</p>
<p>singletonä½œç”¨åŸŸæ˜¯IOCä¸­é»˜è®¤çš„ä½œç”¨åŸŸï¼Œä»£è¡¨å•ä¾‹ã€‚æ¯æ¬¡ä½¿ç”¨beançš„æ—¶å€™ï¼Œä¸ä¼šé‡æ–°åˆ›å»ºå¯¹è±¡ï¼Œåœ¨æ•´ä¸ªIOCå®¹å™¨ä¸­è¯¥ç±»å‹çš„å¯¹è±¡åªæœ‰ä¸€ä¸ªã€‚</p>
<figure data-type="image" tabindex="2"><img src="https://docs.spring.io/spring/docs/5.2.0.RELEASE/spring-framework-reference/images/singleton.png" alt="å•ä¾‹ä½œç”¨åŸŸç¤ºæ„å›¾"></figure>
</li>
</ul>
<h2 id="beançš„ç”Ÿå‘½å‘¨æœŸ">Beançš„ç”Ÿå‘½å‘¨æœŸ</h2>
<ul>
<li>Singleton Beançš„ç”Ÿå‘½å‘¨æœŸ
<ul>
<li>åˆå§‹åŒ–æ—¶æœºï¼š åœ¨IOCå®¹å™¨åˆå§‹åŒ–æ—¶ï¼Œå°±ä¼šæŠŠé…ç½®çš„æ‰€æœ‰å•ä¾‹beanå®ä¾‹åŒ–ã€‚</li>
<li>é”€æ¯æ—¶æœºï¼šåœ¨IOCå®¹å™¨é”€æ¯æ—¶ï¼Œæ‰€æœ‰beançš„é”€æ¯æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚</li>
</ul>
</li>
<li>Prototype Beançš„ç”Ÿå‘½å‘¨æœŸ
<ul>
<li>åˆå§‹åŒ–æ—¶æœºï¼š åœ¨å®é™…ä½¿ç”¨è¯¥beançš„æ—¶å€™ï¼Œæ¯”å¦‚ï¼šgetBeanã€è·å–ä¾èµ–æ­¤beançš„å…¶ä»–beanéœ€è¦ä½¿ç”¨</li>
<li>é”€æ¯æ—¶æœºï¼š åœ¨IOCå®¹å™¨é”€æ¯æ—¶ã€‚ï¼ˆä½†æ˜¯é€šè¿‡destroy-methodæŒ‡å®šçš„å£°æ˜å‘¨æœŸæ–¹æ³•ä¸ä¼šè¢«è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´Springä¸æä¾›prototypebeanå®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼‰</li>
</ul>
</li>
<li>å¦‚ä½•æŒ‡å®šç”Ÿå‘½å‘¨æœŸçš„å›è°ƒæ–¹æ³•
<ul>
<li>xmlä¸­çš„init-methodã€destroy-method</li>
<li>æ³¨è§£æ–¹å¼@PostConstrutorã€@PreDestroy</li>
</ul>
</li>
<li>æŒ‡å®šé»˜è®¤çš„å£°æ˜å‘¨æœŸå›è°ƒæ–¹æ³•
<ul>
<li>åœ¨xmlä¸­ï¼Œé€šè¿‡åœ¨beansæ ‡ç­¾ä¸Šæ·»åŠ default-init-methodã€default-destory-methodæ¥æŒ‡å®š</li>
<li>åœ¨æ³¨è§£é…ç½®ä¸­ï¼Œæ²¡æœ‰å¯¹åº”çš„æ–¹æ³•å¯ä»¥è®¾ç½®æ‰€æœ‰beané»˜è®¤çš„ç”Ÿå‘½å‘¨æœŸå›è°ƒ</li>
</ul>
</li>
</ul>
<h2 id="beanæ‡’åŠ è½½">Beanæ‡’åŠ è½½</h2>
<p>lazy-initå±æ€§</p>
<p>é»˜è®¤æ˜¯false</p>
<blockquote>
<p>æ‡’åŠ è½½é…ç½®ä¸»è¦æ˜¯é’ˆå¯¹å•ä¾‹çš„beanï¼Œå› ä¸ºå®ƒé»˜è®¤æ˜¯åœ¨å®¹å™¨åˆå§‹åŒ–æ—¶å°±è¢«å®ä¾‹åŒ–äº†ã€‚</p>
</blockquote>
<h2 id="å¦‚ä½•ä¼˜é›…çš„åœæ­¢éweb-springåº”ç”¨">å¦‚ä½•ä¼˜é›…çš„åœæ­¢éWeb Springåº”ç”¨</h2>
<p>æ·»åŠ ä¸€ä¸ªshutdown hookã€‚æ‰€æœ‰æ´¾ç”Ÿè‡ªConfigurableApplicationContextæ¥å£çš„å®ç°ç±»éƒ½æ”¯æŒæ­¤æ–¹æ³•</p>
<pre><code class="language-java">ConfigurableApplicationContext ctx = new ClassPathXmlApplicationContext(&quot;xxx.xml&quot;);

ctx.registerShutdownHook(); //æ³¨å†Œåœæ­¢å›è°ƒ
</code></pre>
<h1 id="spring-di">Spring DI</h1>
<h2 id="æ¦‚è¿°">æ¦‚è¿°</h2>
<p>DIçš„å…¨ç§°æ˜¯Dependency Injectionï¼ˆä¾èµ–æ³¨å…¥ï¼‰ã€‚IOCæ˜¯å°†æˆ‘ä»¬å·¥ç¨‹ä¸­çš„æ‰€æœ‰å¯¹è±¡äº¤ç”±Springæ¥ç®¡ç†ï¼ŒDIæ˜¯æ­¤åŸºç¡€ï¼Œå°†å¯¹è±¡ä¸­çš„å±æ€§ã€ä¾èµ–çš„å…¶ä»–å¯¹è±¡ä¹Ÿç®¡ç†èµ·æ¥ï¼Œè‡ªåŠ¨æ³¨å…¥åˆ°ç”±Springå¸®æˆ‘ä»¬ç®¡ç†çš„å¯¹è±¡ä¸­ã€‚</p>
<blockquote>
<p>å°†è¦æ³¨å…¥çš„å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡éƒ½å¿…é¡»æ˜¯ç”±SpringIOCç®¡ç†çš„bean.</p>
</blockquote>
<h2 id="diçš„ç»†èŠ‚å®ç°">DIçš„ç»†èŠ‚å®ç°</h2>
<h3 id="æ„é€ å‚æ•°æ³¨å…¥">æ„é€ å‚æ•°æ³¨å…¥</h3>
<p>å°†ä¸€ä¸ªbeanåˆ›å»ºè¿‡ç¨‹ä¸­æ„é€ æ–¹æ³•éœ€è¦çš„å‚æ•°ï¼Œé€šè¿‡Spring DIçš„æ–¹å¼ï¼Œè‡ªåŠ¨æ³¨å…¥åˆ°æ„é€ æ–¹æ³•ä¸­ã€‚</p>
<h3 id="setteræ³¨å…¥">Setteræ³¨å…¥</h3>
<p>å…ˆé€šè¿‡ä¸€ä¸ªæ— å‚çš„æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼Œç„¶åé€šè¿‡å±æ€§çš„setteræ–¹æ³•ï¼Œå°†å±æ€§å€¼æ³¨å…¥åˆ°å¯¹è±¡ä¸Šã€‚</p>
<h3 id="æ”¯æŒæ³¨å…¥çš„ç±»å‹">æ”¯æŒæ³¨å…¥çš„ç±»å‹</h3>
<ul>
<li>
<p>æ™®é€šå­—é¢é‡</p>
<ul>
<li>String</li>
<li>Integer(int)</li>
<li>Long(long)</li>
<li>Byte(byte)</li>
<li>...</li>
</ul>
</li>
<li>
<p>é›†å’Œç±»å‹</p>
<ul>
<li>
<p>List</p>
<pre><code class="language-xml">&lt;bean id=&quot;xxx&quot; class=&quot;xx.xxx.xxx.AA&quot;&gt;&lt;/bean&gt;
&lt;bean&gt;
    &lt;property name=&quot;hobbies&quot;&gt;
    	&lt;list&gt;
        	&lt;value&gt;ç®€å•ç±»å‹å€¼&lt;/value&gt;
            &lt;bean&gt;å†…éƒ¨bean&lt;/bean&gt;
            &lt;ref bean=&quot;xxx&quot; /&gt;
        &lt;/list&gt;
    &lt;/property&gt;
&lt;/bean&gt;
</code></pre>
</li>
<li>
<p>Map</p>
<pre><code class="language-xml">&lt;bean id=&quot;xxx&quot; class=&quot;xx.xxx.xxx.AA&quot;&gt;&lt;/bean&gt;
&lt;bean&gt;
    &lt;property name=&quot;gameTitle&quot;&gt;
    	&lt;map&gt;
        	&lt;entry key=&quot;ç‹è€…è£è€€&quot; value=&quot;è£è€€ç‹è€…&quot; /&gt;
            &lt;entry key=&quot;ç‹è€…è£è€€&quot; value-ref=&quot;xxx&quot; /&gt;
        &lt;/list&gt;
    &lt;/property&gt;
&lt;/bean&gt;
</code></pre>
</li>
<li>
<p>Set</p>
<pre><code class="language-xml">&lt;bean id=&quot;xxx&quot; class=&quot;xx.xxx.xxx.AA&quot;&gt;&lt;/bean&gt;
&lt;bean&gt;
    &lt;property name=&quot;hobbies&quot;&gt;
    	&lt;!-- setç”¨æ³•å’ŒListç±»ä¼¼ï¼Œ é‡Œé¢å¯ä»¥æ³¨å…¥æ™®é€šå­—é¢é‡å€¼ã€ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªbeanå¼•ç”¨ï¼Œæˆ–è€…å†…éƒ¨beanã€æˆ–è€…æ˜¯ä¸€ä¸ªsetã€listã€Properties  --&gt;
        &lt;set&gt;
        	&lt;value&gt;ç®€å•ç±»å‹å€¼&lt;/value&gt;
            &lt;bean&gt;å†…éƒ¨bean&lt;/bean&gt;
            &lt;ref bean=&quot;xxx&quot; /&gt;
        &lt;/set&gt;
    &lt;/property&gt;
&lt;/bean&gt;
</code></pre>
</li>
<li>
<p>java.util.Properties</p>
<pre><code class="language-xml">&lt;!-- propsæ ‡ç­¾æ˜¯ç”¨æ¥æ³¨å…¥java.util.Propertiesç±»å‹çš„å±æ€§ï¼Œç”¨æ³•å’Œmapç±»ä¼¼ï¼Œä½†æ˜¯å±æ€§å€¼æ˜¯åœ¨æ ‡ç­¾ä¸­é—´å†™ --&gt;
&lt;property name=&quot;gameNick&quot;&gt;
    &lt;props&gt;
        &lt;prop key=&quot;ç‹è€…è£è€€&quot;&gt;æœ€æ“…é•¿1V5&lt;/prop&gt;
        &lt;prop key=&quot;åƒé¸¡&quot;&gt;ä¸€æªçˆ†å¤´&lt;/prop&gt;
    &lt;/props&gt;
&lt;/property&gt;
</code></pre>
</li>
<li>
<p>æ³¨å…¥ç©ºç½®ã€ç©ºå­—ç¬¦ä¸²</p>
<pre><code class="language-xml">&lt;property name=&quot;gameNick&quot;&gt;
    &lt;null /&gt;
&lt;/property&gt;


&lt;property name=&quot;gameNick&quot; value=&quot;&quot; /&gt;
</code></pre>
</li>
</ul>
</li>
</ul>
<h3 id="è‡ªåŠ¨è£…é…">è‡ªåŠ¨è£…é…</h3>
<h5 id="è‡ªåŠ¨è£…é…æ”¯æŒçš„ç­–ç•¥">è‡ªåŠ¨è£…é…æ”¯æŒçš„ç­–ç•¥</h5>
<ul>
<li>
<p>byType</p>
<p>æŒ‰ç…§ç±»å‹å»IOCå®¹å™¨ä¸­æ‰¾éœ€è¦çš„beanï¼Œå¦‚æœæ‰¾åˆ°ä¸€ä¸ªï¼Œåˆ™è‡ªåŠ¨è£…é…ï¼›å¦‚æœæ²¡æ‰¾åˆ°ï¼Œä¸æ³¨å…¥æ­¤å±æ€§ï¼›å¦‚æœæ‰¾åˆ°äº†å¤šä¸ªåŒ¹é…ç±»å‹çš„beanï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
</li>
<li>
<p>byName</p>
<p>æŒ‰ç…§åç§°å»IOCå®¹å™¨ä¸­æ‰¾éœ€è¦çš„beanï¼Œå¦‚æœæ‰¾åˆ°å°±è‡ªåŠ¨æ³¨å…¥ï¼›å¦‚æœæ²¡æ‰¾åˆ°ï¼Œä¸æ³¨å…¥æ­¤å±æ€§ã€‚</p>
</li>
<li>
<p>constructor</p>
<p>å·¥ä½œåŸç†å’ŒbyTypeç±»ä¼¼ï¼Œä¹Ÿæ˜¯æŒ‰ç…§ç±»å‹å»IOCå®¹å™¨ä¸­æ‰¾å¯¹åº”çš„beanã€‚ä¸åŒçš„æ˜¯æ³¨å…¥çš„åœ°æ–¹ä¸æ˜¯setterï¼Œè€Œæ˜¯æ„é€ æ–¹æ³•çš„å‚æ•°ã€‚</p>
</li>
<li>
<p>no  ï¼ˆé»˜è®¤å€¼ï¼‰</p>
<p>å¦‚æœæ²¡æœ‰æ‰“å¼€è‡ªåŠ¨æ³¨å…¥ï¼Œé»˜è®¤Springä¸ä¼šè‡ªåŠ¨è£…é…éœ€è¦çš„å±æ€§ã€‚</p>
</li>
</ul>
<h2 id="xmlæ–¹å¼çš„di">XMLæ–¹å¼çš„DI</h2>
<h3 id="æ„é€ å‚æ•°æ³¨å…¥-2">æ„é€ å‚æ•°æ³¨å…¥</h3>
<ul>
<li>
<p>å¸¸è§„å†™æ³•</p>
<pre><code class="language-xml">&lt;bean id=&quot;xx&quot; class=&quot;&quot; /&gt;
&lt;bean class=&quot;com.test.XXX&quot;&gt;
	&lt;constructor-arg name=&quot;age&quot; value=&quot;45&quot; /&gt;
    &lt;constructor-arg name=&quot;x&quot; ref=&quot;xx&quot; /&gt;  &lt;!-- æ³¨å…¥å¼•ç”¨çš„bean --&gt;
    &lt;constructor-arg name=&quot;&quot;&gt;	&lt;!-- æ³¨å…¥å†…éƒ¨bean --&gt;
    	&lt;bean&gt;&lt;/bean&gt;
    &lt;/constructor-arg&gt;
    &lt;constructor-arg name=&quot;&quot;&gt;	&lt;!-- æ³¨å…¥listç±»å‹æ„é€ å‚æ•° --&gt;
    	&lt;list&gt;
        	
        &lt;/list&gt;
    &lt;/constructor-arg&gt;
    ....
&lt;/bean&gt;
</code></pre>
</li>
<li>
<p>cå‘½åç©ºé—´ç®€å†™</p>
<pre><code class="language-xml">&lt;bean id=&quot;xx&quot; class=&quot;&quot; /&gt;
&lt;bean class=&quot;com.test.XXX&quot; c:age=&quot;45&quot; c:x-ref=&quot;xx&quot; /&gt;
</code></pre>
</li>
</ul>
<h3 id="setteræ–¹å¼æ³¨å…¥">setteræ–¹å¼æ³¨å…¥</h3>
<p>setteræ³¨å…¥èƒ½å¤Ÿæ³¨å…¥çš„ç±»å‹ä»¥åŠå†™æ³•åŸºæœ¬å’Œæ„é€ å‚æ•°æ³¨å…¥æ—¶çš„å†™æ³•ä¸€è‡´ï¼Œåªä¸è¿‡å°†<construtor-arg>æ ‡ç­¾æ¢æˆäº†<property></p>
<ul>
<li>
<p>å¸¸è§„ç”¨æ³•</p>
<pre><code class="language-xml">&lt;bean id=&quot;xx&quot; class=&quot;&quot; /&gt;
&lt;bean class=&quot;com.test.XXX&quot;&gt;
	&lt;property name=&quot;age&quot; value=&quot;45&quot; /&gt;
    &lt;property name=&quot;x&quot; ref=&quot;xx&quot; /&gt;  &lt;!-- æ³¨å…¥å¼•ç”¨çš„bean --&gt;
    &lt;property name=&quot;&quot;&gt;	&lt;!-- æ³¨å…¥å†…éƒ¨bean --&gt;
    	&lt;bean&gt;&lt;/bean&gt;
    &lt;/property&gt;
    &lt;property name=&quot;&quot;&gt;	&lt;!-- æ³¨å…¥listç±»å‹æ„é€ å‚æ•° --&gt;
    	&lt;list&gt;
        	
        &lt;/list&gt;
    &lt;/property&gt;
    ....
&lt;/bean&gt;
</code></pre>
</li>
<li>
<p>på‘½åç©ºé—´ç®€å†™</p>
<pre><code class="language-xml">&lt;bean id=&quot;xx&quot; class=&quot;&quot; /&gt;
&lt;bean class=&quot;com.test.XXX&quot; p:age=&quot;45&quot; p:x-ref=&quot;xx&quot; /&gt;
</code></pre>
</li>
</ul>
<h3 id="å¼€å¯è‡ªåŠ¨è£…é…">å¼€å¯è‡ªåŠ¨è£…é…</h3>
<pre><code class="language-xml">&lt;!-- 
é€šè¿‡ç»™å½“å‰çš„beanæ·»åŠ autowireå±æ€§å¼€å¯è‡ªåŠ¨æ³¨å…¥
å¯é€‰çš„å€¼ï¼šå‚è§è‡ªåŠ¨è£…é…ç« èŠ‚
 --&gt;
&lt;bean id=&quot;xx&quot; class=&quot;&quot; autowire=&quot;&quot; /&gt;
</code></pre>
<h3 id="æé«˜è‡ªåŠ¨è£…é…æ—¶çš„æƒé‡">æé«˜è‡ªåŠ¨è£…é…æ—¶çš„æƒé‡</h3>
<pre><code class="language-xml">&lt;!-- å½“å…¶ä»–çš„beanä¸­éœ€è¦æ³¨å…¥ä¸€ä¸ªTestç±»å‹çš„å±æ€§ï¼Œè€Œæ»¡è¶³æ¡ä»¶çš„beanæœ‰å¤šä¸ªæ—¶ï¼Œä¼šä¼˜å…ˆæ³¨å…¥primary=&quot;true&quot;çš„bean --&gt;
&lt;bean id=&quot;xx&quot; class=&quot;com.Test&quot; primary=&quot;true&quot; /&gt;
</code></pre>
<h3 id="æŒ‰ç±»å‹è‡ªåŠ¨è£…é…æ—¶ä¸å‚ä¸å€™é€‰">æŒ‰ç±»å‹è‡ªåŠ¨è£…é…æ—¶ï¼Œä¸å‚ä¸å€™é€‰</h3>
<pre><code class="language-xml">&lt;!-- å½“å…¶ä»–çš„beanä¸­éœ€è¦æ³¨å…¥ä¸€ä¸ªTestç±»å‹çš„å±æ€§ï¼Œè€Œæ»¡è¶³æ¡ä»¶çš„beanæœ‰å¤šä¸ªæ—¶ï¼Œautowire-candidate=&quot;false&quot;çš„beanä¼šè‡ªåŠ¨é€€å‡ºå€™é€‰åºåˆ— --&gt;
&lt;bean id=&quot;xx&quot; class=&quot;com.Test&quot; autowire-candidate=&quot;false&quot; /&gt;
</code></pre>
<h2 id="æ³¨è§£æ–¹å¼çš„di">æ³¨è§£æ–¹å¼çš„DI</h2>
<ul>
<li>
<p>æ„é€ å‚æ•°æ³¨å…¥</p>
<p>åœ¨æ„é€ æ–¹æ³•ä¸Šæ·»åŠ  <code>@Autowired</code>æ³¨è§£ï¼Œæ„é€ æ–¹æ³•çš„å‚æ•°å°±ä¼šè‡ªåŠ¨æ³¨å…¥è¿›æ¥</p>
</li>
<li>
<p>setteræ–¹æ³•æ³¨å…¥</p>
<p>æ–¹æ³•æœ‰ä¸¤ç§ï¼š</p>
<ol>
<li>åœ¨å±æ€§çš„setteræ–¹æ³•ä¸Šæ·»åŠ <code>@Autowired</code>æ³¨è§£</li>
<li>åœ¨å±æ€§ä¸Šæ·»åŠ <code>@Autowired</code>æ³¨è§£</li>
</ol>
</li>
</ul>
<h3 id="æé«˜è‡ªåŠ¨è£…é…æ—¶çš„æƒé‡-2">æé«˜è‡ªåŠ¨è£…é…æ—¶çš„æƒé‡</h3>
<pre><code class="language-java">@Primary
@Component
public class Test {


}

public class Main {
    
    @Primary
    @Bean
    public void test() {
        return new Test();
    }
    
}
</code></pre>
<h2 id="æ³¨å…¥å¤–éƒ¨propertyæ–‡ä»¶ä¸­çš„å±æ€§å€¼">æ³¨å…¥å¤–éƒ¨Propertyæ–‡ä»¶ä¸­çš„å±æ€§å€¼</h2>
<h3 id="åœ¨xmlä¸­çš„é…ç½®æ–¹å¼">åœ¨XMLä¸­çš„é…ç½®æ–¹å¼</h3>
<pre><code class="language-xml">&lt;!-- æ·»åŠ contextå‘½åç©ºé—´ --&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
	xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;


&lt;!-- å¯¼å…¥å¤–éƒ¨propertiesæ–‡ä»¶åˆ°iocä¸Šä¸‹æ–‡ä¸­ --&gt;
&lt;context:property-placeholder location=&quot;jdbc.properties&quot; /&gt;

&lt;!-- ä½¿ç”¨å ä½ç¬¦çš„æ–¹å¼è·å–propertiesæ–‡ä»¶ä¸­çš„å±æ€§å€¼ --&gt;
&lt;bean id=&quot;dataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot; init-method=&quot;init&quot; destroy-method=&quot;close&quot;&gt;
    &lt;property name=&quot;url&quot; value=&quot;${jdbc.url}&quot; /&gt;
    &lt;property name=&quot;username&quot; value=&quot;${jdbc.user}&quot; /&gt;
    &lt;property name=&quot;password&quot; value=&quot;${jdbc.password}&quot; /&gt;
    &lt;property name=&quot;driverClassName&quot; value=&quot;${jdbc.driver}&quot; /&gt;
&lt;/bean&gt;
</code></pre>
<h3 id="åœ¨æ³¨è§£ä¸­çš„é…ç½®æ–¹å¼">åœ¨æ³¨è§£ä¸­çš„é…ç½®æ–¹å¼</h3>
<p>é€šè¿‡<code>@PropertySource</code>æ³¨è§£å¯ä»¥å°†å¤–éƒ¨propertiesæ–‡ä»¶å¯¼å…¥åˆ°ä¸Šä¸‹æ–‡ä¸­ï¼Œé€šè¿‡<code>@Value</code>æ³¨è§£å¯ä»¥è·å–propertiesæ–‡ä»¶ä¸­çš„å±æ€§å€¼ï¼Œå¹¶æ³¨å…¥åˆ°å½“å‰ç±»çš„å±æ€§ä¸­</p>
<pre><code class="language-java">@Configuration
@ComponentScan(basePackages = &quot;com.lanou.spring&quot;)
@PropertySource(&quot;classpath:/jdbc.properties&quot;)
public class MyConfiguration {

	@Value(&quot;${jdbc.url}&quot;)
    private String url;
    @Value(&quot;${jdbc.user}&quot;)
    private String username;
    @Value(&quot;${jdbc.password}&quot;)
    private String password;
    @Value(&quot;${jdbc.driver}&quot;)
    private String driverClassName;
}
</code></pre>
<h1 id="springaop">SpringAOP</h1>
<h2 id="æ¦‚è¿°-2">æ¦‚è¿°</h2>
<p>AOPçš„å…¨ç§°æ˜¯Aspect Oriented  Programming(é¢å‘åˆ‡é¢ç¼–ç¨‹)</p>
<p>OOPè¯­è¨€æä¾›äº†ç±»ä¸ç±»ä¹‹é—´çºµå‘çš„å…³ç³»ï¼ˆç»§æ‰¿ã€æ¥å£ï¼‰ï¼Œè€ŒAOPè¡¥å……äº†æ¨ªå‘çš„å…³ç³»ï¼ˆæ¯”å¦‚åœ¨ä¸æ”¹å˜ç›®æ ‡ç±»ä¸­æºä»£ç çš„æƒ…å†µä¸‹ç»™com.john.demo.daoåŒ…ä¸‹æ‰€æœ‰ç±»ä¸­ä»¥insertå’Œupdateå¼€å¤´çš„æ–¹æ³•æ·»åŠ äº‹åŠ¡ç®¡ç†ï¼‰</p>
<h3 id="springaopå’Œaspectjçš„åŒºåˆ«">SpringAOPå’ŒAspectJçš„åŒºåˆ«</h3>
<p>AspectJæ˜¯ä¸€ä¸ªä¸“é—¨ä¸»æ‰“é¢å‘åˆ‡é¢ç¼–ç¨‹çš„æ¡†æ¶ã€‚ å®ƒæ˜¯ä½¿ç”¨ä¸€ç§ç‰¹æ®Šçš„è¯­è¨€(æ‰©å±•è‡ªJavaè¯­è¨€)æ¥ç¼–å†™åˆ‡é¢ä»£ç ï¼Œåç¼€æ˜¯.ajæ ¼å¼ï¼Œå¹¶ä¸”éœ€è¦ä½¿ç”¨ä¸“é—¨çš„ç¼–è¯‘å™¨å°†å…¶ç¼–è¯‘æˆjvmå¯ä»¥è¿è¡Œçš„classæ–‡ä»¶ã€‚</p>
<p>SpringAOPåº•å±‚ä¹Ÿæ˜¯ä½¿ç”¨äº†AspectJçš„æ–¹æ¡ˆï¼Œä½†æ˜¯åœ¨ä¸Šå±‚åšäº†å¾ˆå¤šå°è£…å±‚é¢çš„å·¥ä½œï¼Œå¯ä»¥è®©å¼€å‘äººå‘˜ç›´æ¥ä½¿ç”¨Javaä»£ç æ¥ç¼–å†™åˆ‡é¢ã€‚å¹¶ä¸”ç”±äºä½¿ç”¨çš„æ˜¯æ ‡å‡†çš„Javaè¯­è¨€ï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦åœ¨é¢å¤–å®‰è£…ä¸€ä¸ªä¸“é—¨çš„ç¼–è¯‘å™¨ã€‚ä½†æ˜¯ç”±äºå¼€å‘äººå‘˜ç›´æ¥æ¥è§¦çš„æ˜¯Spring AOPï¼Œé‚£ä¹ˆå‡¡æ˜¯Springä¸­æ²¡æœ‰å®ç°çš„é‚£äº›AOPåŠŸèƒ½ï¼Œæˆ‘ä»¬å°±ç”¨ä¸äº†äº†ï¼Œè¿™ç§æƒ…å†µä¸‹åªèƒ½è·Ÿäº§å“ç»ç†æ’•é€¼æˆ–è€…å»å­¦ä¹ åŸç”Ÿçš„AspectJã€‚</p>
<h2 id="aopçš„æœ¯è¯­">AOPçš„æœ¯è¯­</h2>
<ul>
<li>
<p>åˆ‡é¢ï¼ˆAspectï¼‰</p>
<p>ç®€å•æ¥è¯´ï¼Œåˆ‡é¢å°±æ˜¯æˆ‘ä»¬è¦å¾€ç›®æ ‡ä»£ç ä¸­æ’å…¥è¿›å»çš„ä»£ç ã€‚</p>
</li>
<li>
<p>è¿æ¥ç‚¹ï¼ˆJoin Pointerï¼‰</p>
<p>ç†è®ºä¸Šæ‰€æœ‰å¯èƒ½ä¼šè¢«åˆ‡å…¥çš„åœ°æ–¹éƒ½å¯ä»¥ç§°ä¹‹ä¸ºè¿æ¥ç‚¹</p>
</li>
<li>
<p>åˆ‡å…¥ç‚¹(Pointcut)</p>
<p>é€‰æ‹©æŸä¸ªè¿æ¥ç‚¹åˆ‡å…¥ï¼Œå°†åˆ‡é¢ä»£ç ç»‡å…¥è¿›å»ã€‚è¿™ä¸ªè¿æ¥ç‚¹å°±å«åšåˆ‡å…¥ç‚¹ã€‚</p>
</li>
<li>
<p>ç»‡å…¥(Weaving)</p>
<p>æŠŠåˆ‡é¢ä»£ç ç³…åˆåˆ°ç›®æ ‡ä»£ç ä¸­çš„è¿‡ç¨‹å°±æ˜¯ç»‡å…¥ã€‚</p>
</li>
<li>
<p>é€šçŸ¥(Advice)</p>
<p>é€šçŸ¥å†³å®šäº†åˆ‡é¢ä»£ç ç»‡å…¥åˆ°ç›®æ ‡ä»£ç ä¸­åï¼Œè¿è¡Œçš„æ—¶æœº(æ¯”å¦‚æ˜¯åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œå‰ï¼Œè¿˜æ˜¯æ‰§è¡Œå)ã€‚</p>
</li>
</ul>
<h2 id="åœ¨springä¸­ä½¿ç”¨aop">åœ¨Springä¸­ä½¿ç”¨AOP</h2>
<h3 id="åŸºäºxmlæ–¹å¼ä½¿ç”¨">åŸºäºXMLæ–¹å¼ä½¿ç”¨</h3>
<ol>
<li>
<p>æŠŠaopçš„schemaå¼•å…¥</p>
<pre><code class="language-xml">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/aop
       http://www.springframework.org/schema/aop/spring-aop.xsd&quot;&gt;
</code></pre>
</li>
<li>
<p>åˆ›å»ºä¸€ä¸ªåˆ‡é¢ç±»ï¼Œå¹¶ä¸”ä»¥beançš„æ–¹å¼é…ç½®åˆ°IOCå®¹å™¨ä¸­</p>
<pre><code class="language-java">package com.lanou3g.spring;
public class MyAspect {

    public void wakeup() {
        System.out.println(&quot;[å‰ç½®é€šçŸ¥]æˆ‘åˆšå­¦ä¹ SpringAOPç¡ç€äº†ï¼Œåˆšæ‰è°æ‰“äº†æˆ‘ä¸€ä¸‹ï¼Ÿ&quot;);
    }


    public void goToBed() {
        System.out.println(&quot;[åç½®é€šçŸ¥]SpringAOPå¤ªéš¾äº†ï¼Œä¸€ä¸å°å¿ƒåˆç¡ç€äº†&quot;);
    }


    public void afterRetuing(Object message) {
        System.out.println(&quot;[åç½®è¿”å›é€šçŸ¥]æ–¹æ³•æ‰§è¡Œå·²ç»returnäº†ï¼Œæ–¹æ³•è¿”å›å€¼æ˜¯ï¼š&quot; + message);
    }

    public void afterThrowing(Throwable ex) {
        System.out.println(&quot;[åç½®å¼‚å¸¸é€šçŸ¥]æ–¹æ³•æ‰§è¡Œå‡ºç°å¼‚å¸¸ï¼Œå¼‚å¸¸åŸå› ï¼š&quot; + ex.getMessage());
    }

    /**
     * ç¯ç»•é€šçŸ¥
     * å¯ä»¥æ¥å—ä¸€ä¸ªProceedingJoinPointå‚æ•°
     *      é€šè¿‡æ­¤å‚æ•°å¯ä»¥è·å–åˆ°è¢«åˆ‡å…¥æ–¹æ³•çš„æ‰€æœ‰ä¿¡æ¯
     *      è¿˜å¯ä»¥é€šè¿‡æ­¤å‚æ•°æ¥å†³å®šæ˜¯å¦è°ƒç”¨ç›®æ ‡æ–¹æ³•
     */
    public void aroundAdvice(ProceedingJoinPoint joinPoint) {

        // è¿æ¥ç‚¹å‚æ•°å¯ä»¥è·å–åˆ°è¢«åˆ‡å…¥æ–¹æ³•çš„æ‰€æœ‰ä¿¡æ¯
        // è¿™é‡Œæ¼”ç¤ºäº†å¦‚ä½•è·å–è¢«åˆ‡å…¥æ–¹æ³•çš„åç§°
        String targetMethodName = joinPoint.getSignature().getName();
        System.out.println(&quot;[ç¯ç»•é€šçŸ¥]è¢«åˆ‡å…¥çš„æ–¹æ³•åï¼š&quot; + targetMethodName);

        //
        System.out.println(&quot;[ç¯ç»•é€šçŸ¥]å³å°†å¼€å§‹æ–°çš„ä¸€å¤©ï¼Œ æ—©èµ·çš„é¸Ÿå„¿æœ‰è™«åƒï¼&quot;);
        try {
            joinPoint.proceed();
        } catch (Throwable throwable) {
            throwable.printStackTrace();
        }
        System.out.println(&quot;[ç¯ç»•é€šçŸ¥]è¿™çœŸæ˜¯å……å®çš„ä¸€å¤©ï¼Œ æ—©ç¡æ—©èµ·ï¼Œæ–¹èƒ½å…»ç”Ÿï¼&quot;);
    }
}
</code></pre>
<pre><code class="language-xml">&lt;bean id=&quot;myAspect&quot; class=&quot;com.lanou3g.spring.MyAspect&quot; /&gt;
</code></pre>
</li>
<li>
<p>ä½¿ç”¨<a href="aop:config">aop:config</a>æ ‡ç­¾é…ç½®aopï¼ˆå°†åˆ‡é¢ã€åˆ‡å…¥ç‚¹ã€é€šçŸ¥ç»“åˆåˆ°ä¸€èµ·ï¼‰</p>
<ol>
<li>å®šä¹‰åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</li>
<li><a href="aop:aspect">aop:aspect</a>
<ol>
<li>å¼•ç”¨å¤–éƒ¨å®šä¹‰çš„åˆ‡é¢bean</li>
<li>é…ç½®é€šçŸ¥ï¼Œå¼•ç”¨åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</li>
</ol>
</li>
</ol>
<pre><code class="language-xml">&lt;aop:config&gt;
    &lt;!-- åˆ‡å…¥ç‚¹è¡¨ç¤ºåŒ¹é…com.lanou3g.springåŒ…ä¸‹çš„æ‰€æœ‰ç±»ä¸­æ‰€æœ‰ä»¥oneDayå¼€å¤´çš„æ–¹æ³•ï¼Œæ–¹æ³•çš„å‚æ•°ã€è¿”å›å€¼ä¸é™ --&gt;
	&lt;aop:pointcut id=&quot;myPointcut&quot; expression=&quot;execution(* com.lanou3g.spring..*.oneDay*(..))&quot; /&gt;
    &lt;aop:aspect ref=&quot;myAspect&quot;&gt;
    	&lt;!-- æ— è®ºæ˜¯å¦å‡ºç°å¼‚å¸¸ï¼Œåªè¦è¢«åˆ‡å…¥çš„æ–¹æ³•å¼€å§‹è¿è¡Œï¼Œéƒ½ä¼šè§¦å‘æ­¤é€šçŸ¥ --&gt;
            &lt;aop:before method=&quot;wakeup&quot; pointcut-ref=&quot;beforeOneDay&quot; /&gt;
            &lt;!-- æ— è®ºæ˜¯å¦å‡ºç°å¼‚å¸¸ï¼Œåªè¦è¢«åˆ‡å…¥çš„æ–¹æ³•è¿è¡Œç»“æŸï¼Œéƒ½ä¼šè§¦å‘æ­¤é€šçŸ¥ --&gt;
            &lt;aop:after method=&quot;goToBed&quot; pointcut-ref=&quot;beforeOneDay&quot; /&gt;
            &lt;!--
            å¯ä»¥æœ€å¤§é™åº¦çš„å¯¹è¢«åˆ‡å…¥æ–¹æ³•é™„åŠ åŠŸèƒ½ï¼Œåœ¨æ–¹æ³•æ‰§è¡Œå‰ã€åéƒ½å¯ä»¥é€šçŸ¥ï¼ˆæ— è®ºæ˜¯å¦å‡ºç°å¼‚å¸¸ï¼‰
            ï¼Œè¿˜å¯ä»¥è·å–åˆ°è¢«åˆ‡å…¥æ–¹æ³•çš„æ‰€æœ‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ˜¯å¦è°ƒç”¨è¢«åˆ‡å…¥çš„æ–¹æ³•
            --&gt;
            &lt;aop:around method=&quot;aroundAdvice&quot; pointcut-ref=&quot;beforeOneDay&quot; /&gt;
            &lt;!-- è¢«åˆ‡å…¥çš„æ–¹æ³•æ­£å¸¸è¿”å›å€¼ä»¥åï¼Œä¼šè§¦å‘æ­¤é€šçŸ¥ --&gt;
            &lt;aop:after-returning method=&quot;afterRetuing&quot; pointcut-ref=&quot;beforeOneDay&quot; returning=&quot;message&quot; /&gt;
            &lt;!-- è¢«åˆ‡å…¥çš„æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ä»¥åï¼Œä¼šè§¦å‘æ­¤é€šçŸ¥ï¼Œå¹¶ä¸”ä¸ä¼šè§¦å‘after-returning --&gt;
            &lt;aop:after-throwing method=&quot;afterThrowing&quot; pointcut-ref=&quot;beforeOneDay&quot; throwing=&quot;ex&quot; /&gt;
    &lt;/aop:aspect&gt;
&lt;/aop:config&gt;
</code></pre>
</li>
</ol>
<h3 id="åŸºäºæ³¨è§£æ–¹å¼ä½¿ç”¨">åŸºäºæ³¨è§£æ–¹å¼ä½¿ç”¨</h3>
<ol>
<li>
<p>å¼€å¯AOPæ³¨è§£æ”¯æŒ</p>
<p>æ–¹å¼ä¸€ï¼šæ³¨è§£çš„æ–¹å¼</p>
<pre><code class="language-xml">@Configuration
@EnableAspectJAutoProxy
public class AppConfig {

}
</code></pre>
<p>æ–¹å¼äºŒï¼šxmlä¸­å¼€å¯</p>
<pre><code class="language-xml">&lt;aop:aspectj-autoproxy/&gt;
</code></pre>
<ol start="2">
<li>å®šä¹‰åˆ‡é¢ç±»</li>
</ol>
<pre><code class="language-java">/**
 * è¯¥åˆ‡é¢ç”¨æ¥æ’å…¥èµ·åºŠçš„é€»è¾‘
 */
@Aspect
@Component  //@Aspectæ³¨è§£æ²¡æœ‰å°†beanäº¤ç»™iocå®¹å™¨ç®¡ç†çš„åŠŸèƒ½
public class MyAspect {

    @Before(&quot;com.lanou3g.spring.aop.MyPointcut.allOneDayMehtod()&quot;)
    public void wakeup() {
        System.out.println(&quot;[å‰ç½®é€šçŸ¥]æˆ‘åˆšå­¦ä¹ SpringAOPç¡ç€äº†ï¼Œåˆšæ‰è°æ‰“äº†æˆ‘ä¸€ä¸‹ï¼Ÿ&quot;);
    }

    @After(&quot;com.lanou3g.spring.aop.MyPointcut.allOneDayMehtod()&quot;)
    public void goToBed() {
        System.out.println(&quot;[åç½®é€šçŸ¥]SpringAOPå¤ªéš¾äº†ï¼Œä¸€ä¸å°å¿ƒåˆç¡ç€äº†&quot;);
    }

    @AfterReturning(value = &quot;com.lanou3g.spring.aop.MyPointcut.allOneDayMehtod()&quot;, returning = &quot;message&quot;)
    public void afterRetuing(Object message) {
        System.out.println(&quot;[åç½®è¿”å›é€šçŸ¥]æ–¹æ³•æ‰§è¡Œå·²ç»returnäº†ï¼Œæ–¹æ³•è¿”å›å€¼æ˜¯ï¼š&quot; + message);
    }

    @AfterThrowing(value = &quot;com.lanou3g.spring.aop.MyPointcut.allOneDayMehtod()&quot;, throwing = &quot;ex&quot;)
    public void afterThrowing(Throwable ex) {
        System.out.println(&quot;[åç½®å¼‚å¸¸é€šçŸ¥]æ–¹æ³•æ‰§è¡Œå‡ºç°å¼‚å¸¸ï¼Œå¼‚å¸¸åŸå› ï¼š&quot; + ex.getMessage());
    }

    /**
     * ç¯ç»•é€šçŸ¥
     * å¯ä»¥æ¥å—ä¸€ä¸ªProceedingJoinPointå‚æ•°
     *      é€šè¿‡æ­¤å‚æ•°å¯ä»¥è·å–åˆ°è¢«åˆ‡å…¥æ–¹æ³•çš„æ‰€æœ‰ä¿¡æ¯
     *      è¿˜å¯ä»¥é€šè¿‡æ­¤å‚æ•°æ¥å†³å®šæ˜¯å¦è°ƒç”¨ç›®æ ‡æ–¹æ³•
     */
//    @Around(&quot;com.lanou3g.spring.aop.MyPointcut.allOneDayMehtod()&quot;)
    public Object aroundAdvice(ProceedingJoinPoint joinPoint) {

        // è¿æ¥ç‚¹å‚æ•°å¯ä»¥è·å–åˆ°è¢«åˆ‡å…¥æ–¹æ³•çš„æ‰€æœ‰ä¿¡æ¯
        // è¿™é‡Œæ¼”ç¤ºäº†å¦‚ä½•è·å–è¢«åˆ‡å…¥æ–¹æ³•çš„åç§°
        String targetMethodName = joinPoint.getSignature().getName();
        System.out.println(&quot;[ç¯ç»•é€šçŸ¥]è¢«åˆ‡å…¥çš„æ–¹æ³•åï¼š&quot; + targetMethodName);

        //
        System.out.println(&quot;[ç¯ç»•é€šçŸ¥]å³å°†å¼€å§‹æ–°çš„ä¸€å¤©ï¼Œ æ—©èµ·çš„é¸Ÿå„¿æœ‰è™«åƒï¼&quot;);
        Object ret = null;
        try {
            ret = joinPoint.proceed();
        } catch (Throwable throwable) {
            throwable.printStackTrace();
        }
        System.out.println(&quot;[ç¯ç»•é€šçŸ¥]è¿™çœŸæ˜¯å……å®çš„ä¸€å¤©ï¼Œ æ—©ç¡æ—©èµ·ï¼Œæ–¹èƒ½å…»ç”Ÿï¼&quot;);
        return ret;
    }
}
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼š@Aspectæ³¨è§£æ²¡æœ‰å°†beanäº¤ç»™iocå®¹å™¨ç®¡ç†çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦é¢å¤–æ·»åŠ ä¸€ä¸ª@Componentæ³¨è§£</p>
</blockquote>
<ol start="3">
<li>å®šä¹‰åˆ‡å…¥ç‚¹</li>
</ol>
<p>å®˜æ–¹å»ºè®®æˆ‘ä»¬å°†æ‰€æœ‰çš„åˆ‡å…¥ç‚¹ç»Ÿä¸€å®šä¹‰åˆ°ä¸€ä¸ªåœ°æ–¹ç®¡ç†ï¼Œåœ¨é…ç½®é€šçŸ¥æ—¶é€šè¿‡å¼•å…¥çš„æ–¹å¼æ¥ä½¿ç”¨ã€‚æ–¹ä¾¿åæœŸç»´æŠ¤ï¼ˆä¸€å¤„ä¿®æ”¹ï¼Œå¤„å¤„ç”Ÿæ•ˆï¼‰</p>
<pre><code class="language-java">@Component
public class MyPointcut {
    // é€šè¿‡@Pointcutæ³¨è§£å®šä¹‰ä¸€ä¸ªåˆ‡å…¥ç‚¹
    @Pointcut(&quot;execution(* oneDay(..))&quot;)
    public void allOneDayMehtod() {}
}
</code></pre>
<ol start="4">
<li>åœ¨åˆ‡é¢ç±»ä¸­æ·»åŠ è¦åˆ‡å…¥çš„ä»£ç </li>
</ol>
<blockquote>
<p>å‚è§å®šä¹‰åˆ‡é¢éƒ¨åˆ†</p>
</blockquote>
<ol start="5">
<li>åœ¨åˆ‡å…¥çš„ä»£ç æ–¹æ³•ä¸Šæ·»åŠ é€šçŸ¥çš„æ³¨è§£</li>
</ol>
<blockquote>
<p>å‚è§å®šä¹‰åˆ‡é¢éƒ¨åˆ†</p>
</blockquote>
</li>
</ol>
<h2 id="spring-aopä»£ç†æœºåˆ¶å®ç°åŸç†">Spring AOPä»£ç†æœºåˆ¶å®ç°åŸç†</h2>
<p>Spring AOPåº•å±‚æ”¯æŒä¸¤ç§åŠ¨æ€å®ç°ï¼š</p>
<ul>
<li>JDKåŸç”Ÿçš„åŠ¨æ€ä»£ç†</li>
<li>CglibåŠ¨æ€ä»£ç†</li>
</ul>
<blockquote>
<p>Springåœ¨åˆ›å»ºä»£ç†å¯¹è±¡æ—¶ï¼Œä¼šè‡ªåŠ¨é€‰æ‹©è¦ä½¿ç”¨å“ªç§ä»£ç†æ–¹æ¡ˆã€‚å¦‚æœè¢«ä»£ç†çš„ç±»å®ç°äº†æ¥å£ï¼Œé‚£ä¹ˆå°±ç”¨JDKåŠ¨æ€ä»£ç†ï¼› åä¹‹å°±ä½¿ç”¨CglibåŠ¨æ€ä»£ç†</p>
</blockquote>
<h3 id="jdkåŸç”ŸåŠ¨æ€ä»£ç†">JDKåŸç”ŸåŠ¨æ€ä»£ç†</h3>
<p>åŒºåˆ«é™æ€ä»£ç†æ¯ä»£ç†ä¸€ä¸ªç±»å°±éœ€è¦åˆ›å»ºä¸€ä¸ªä¸“é—¨çš„ä»£ç†ç±»ï¼ŒåŠ¨æ€ä»£ç†åªéœ€è¦ä¸€ä¸ªé€šç”¨çš„ä»£ç†ç±»ï¼Œå³å¯ä»£ç†æ‰€æœ‰å®ç°äº†æ¥å£çš„ç±»ã€‚</p>
<p>å…³é”®çš„API:</p>
<ul>
<li>
<p>InvocationHandler: å›è°ƒæ¥å£</p>
<pre><code class="language-java">public class MyProxy implements InvacationHandler {
    /**
     *  æ­¤æ–¹æ³•åœ¨é€šè¿‡ä»£ç†å¯¹è±¡å»è°ƒç”¨ç›®æ ‡æ–¹æ³•æ—¶ï¼Œä¼šè‡ªåŠ¨è¿›å…¥æ­¤æ–¹æ³•(å®é™…ä¸Šè°ƒç”¨çš„å°±æ˜¯æ­¤æ–¹æ³•)ï¼Œç›®æ ‡æ–¹æ³•æ—¶åœ¨æ­¤æ–¹æ³•ä¸­è°ƒç”¨çš„(å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä¸è°ƒç”¨)ã€‚

     *  ç¬¬ä¸€ä¸ªå‚æ•°proxy: ä»£ç†å¯¹è±¡(æ³¨æ„ä¸æ˜¯ç›®æ ‡å¯¹è±¡)
     *  ç¬¬äºŒä¸ªå‚æ•°method: è¢«ä»£ç†çš„æ–¹æ³•å¯¹è±¡(æ–¹æ³•æœ¬èº«)
     *  ç¬¬ä¸‰ä¸ªå‚æ•°args: ä»£ç†å¯¹è±¡è°ƒç”¨æ—¶ç©¿è¿›æ¥çš„å‚æ•°ï¼Œç”¨äºåœ¨ä»£ç†æ–¹æ³•ä¸­è°ƒç”¨åŸæ–¹æ³•æ—¶ä¼ å…¥
     *
     */
    @Override
    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {

            String methodName = method.getName();

            // æ¨¡æ‹Ÿåœ¨æ–¹æ³•è¿è¡Œå‰æ‰§è¡Œçš„æ“ä½œ
            System.out.println(methodName+ &quot; å¼€å§‹æ‰§è¡Œäº†&quot;);

            Object retVal =  method.invoke(target, args);

            // æ¨¡æ‹Ÿåœ¨æ–¹æ³•è¿è¡Œåæ‰§è¡Œçš„æ“ä½œ
            System.out.println(methodName+ &quot; æ‰§è¡Œç»“æŸäº†ï¼Œè¿”å›å€¼ï¼š &quot; + retVal);

            return retVal;
    }
}
</code></pre>
</li>
<li>
<p>Proxyï¼š åˆ›å»ºä»£ç†ç±»çš„å·¥å‚ç±»ï¼Œç”¨äºåŠ¨æ€åˆ›å»ºä»£ç†å¯¹è±¡</p>
<ul>
<li>
<p>å¦‚ä½•åˆ›å»ºä»£ç†å¯¹è±¡</p>
<pre><code class="language-java">// 1. åˆ›å»ºä»£ç†å¯¹è±¡
// å‚æ•°è¯´æ˜ï¼š
//		ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç±»åŠ è½½å™¨
//		ç¬¬äºŒä¸ªå‚æ•°æ˜¯è¢«ä»£ç†ç±»å®ç°çš„æ¥å£ï¼Œå¯ä»¥å†™å¤šä¸ª(å†™å‡ ä¸ªæ¥å£å°±ä»£è¡¨ä½ éœ€è¦ä»£ç†ä»å‡ ä¸ªæ¥å£ä¸­å®ç°çš„æ–¹æ³•)
//        ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå®ç°äº†InvacationHandleræ¥å£çš„å¯¹è±¡ï¼Œç”¨äºå›è°ƒ
//        å½“æˆ‘ä»¬é€šè¿‡ä»£ç†å¯¹è±¡å»è°ƒç”¨ç›®æ ‡æ–¹æ³•æ—¶ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œç¬¬ä¸‰ä¸ªå‚æ•°ä¼ è¿›æ¥çš„å›è°ƒæ–¹æ³•
		
Object obj = Proxy.newProxyInstance(classLoader, interfaces..., callback);

// 2. å°†ç±»å‹å¼ºè½¬æˆéœ€è¦ä»£ç†ç±»çš„æ¥å£ç±»å‹
Man man = (Man)obj;

// 3. é€šè¿‡ä»£ç†å¯¹è±¡å»è°ƒç”¨åŸæœ¬æƒ³è°ƒç”¨çš„æ–¹æ³•
man.oneDay();
</code></pre>
</li>
</ul>
</li>
</ul>
<h3 id="cglibåŠ¨æ€ä»£ç†">CglibåŠ¨æ€ä»£ç†</h3>
<p>å…³é”®çš„API</p>
<ul>
<li>
<p>Enhancer: è¯¥ç±»è´Ÿè´£åŠ¨æ€åˆ›å»ºä»£ç†</p>
<ul>
<li>å¦‚ä½•åˆ›å»ºä»£ç†ç±»</li>
</ul>
<pre><code class="language-java">Enhancer enhancer = new Enhancer();	//ç±»ä¼¼äºä¸€ä¸ªåˆ›å»ºä»£ç†å¯¹è±¡çš„å·¥å‚ç±»
// ä¸‹é¢ä¸‰è¡Œç±»ä¼¼äºç»™å·¥å‚å¯¹è±¡è®¾ç½®å‚æ•°
enhancer.setSuperclass(clazz);	// è®©åŠ¨æ€åˆ›å»ºå‡ºæ¥çš„ä»£ç†ç±»ç»§æ‰¿æŒ‡å®šçš„ç±»
enhancer.setCallback(this);	 // æŒ‡å®šè°ƒç”¨ä»£ç†å¯¹è±¡çš„æ–¹æ³•æ—¶ï¼Œè¿›å…¥çš„å›è°ƒæ–¹æ³•
return enhancer.create();	// åˆ›å»ºä»£ç†å¯¹è±¡
</code></pre>
</li>
<li>
<p>MehtodInctercepor: æ‰§è¡Œä»£ç†å¯¹è±¡æ–¹æ³•æ—¶çš„å›è°ƒï¼Œä½œç”¨ç±»ä¼¼äºJDKåŠ¨æ€ä»£ç†ä¸­çš„InvacationHandler</p>
<pre><code class="language-java">public class MyCglibProxy implements MethodInterceptor {

    // åˆ›å»ºåŠ¨æ€ä»£ç†ç±»çš„å·¥å‚å¯¹è±¡
    private Enhancer enhancer = new Enhancer();
    public Object getProxy(Class clazz) {
        enhancer.setSuperclass(clazz);
        enhancer.setCallback(this);
        enhancer.setUseCache(false);
        return enhancer.create();
    }

    /**
     *  æ­¤æ–¹æ³•åœ¨é€šè¿‡ä»£ç†å¯¹è±¡å»è°ƒç”¨ç›®æ ‡æ–¹æ³•æ—¶ï¼Œä¼šè‡ªåŠ¨è¿›å…¥æ­¤æ–¹æ³•(å®é™…ä¸Šè°ƒç”¨çš„å°±æ˜¯æ­¤æ–¹æ³•)ï¼Œç›®æ ‡æ–¹æ³•æ—¶åœ¨æ­¤æ–¹æ³•ä¸­è°ƒç”¨çš„(å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä¸è°ƒç”¨)ã€‚

     *  ç¬¬ä¸€ä¸ªå‚æ•°proxy: ä»£ç†å¯¹è±¡(æ³¨æ„ä¸æ˜¯ç›®æ ‡å¯¹è±¡)
     *  ç¬¬äºŒä¸ªå‚æ•°method: è¢«ä»£ç†çš„æ–¹æ³•å¯¹è±¡(æ–¹æ³•æœ¬èº«)
     *  ç¬¬ä¸‰ä¸ªå‚æ•°args: ä»£ç†å¯¹è±¡è°ƒç”¨æ—¶ç©¿è¿›æ¥çš„å‚æ•°ï¼Œç”¨äºåœ¨ä»£ç†æ–¹æ³•ä¸­è°ƒç”¨åŸæ–¹æ³•æ—¶ä¼ å…¥
     *  ç¬¬å››ä¸ªå‚æ•°methodProxy: æ˜¯Cglibæä¾›çš„ä¸€ä¸ªæ–¹æ³•ä»£ç†å¯¹è±¡ï¼Œä»£ç†äº†ç¬¬äºŒä¸ªå‚æ•°method,å®ƒå¯ä»¥å®ç°ç›´æ¥è°ƒç”¨ä¼ è¿›æ¥å¯¹è±¡çš„çˆ¶ç±»ä¸Šçš„æ–¹æ³•
     */ 
    @Override
    public Object intercept(Object proxy, Method method, Object[] args, MethodProxy methodProxy) throws Throwable {
        String methodName = method.getName();
        System.out.println(methodName + &quot;å¼€å§‹æ‰§è¡Œäº†&quot;);
        //ä»£ç†ç±»å¯¹è±¡å®ä¾‹è°ƒç”¨çˆ¶ç±»æ–¹æ³•ï¼ˆå…¶å®å°±æ˜¯è°ƒç”¨è¢«ä»£ç†ç±»ä¸Šçš„æ–¹æ³•å®ç°ï¼‰
        Object retVal = methodProxy.invokeSuper(proxy, args);
        System.out.println(methodName + &quot;æ‰§è¡Œç»“æŸäº†&quot;);
        return retVal;
    }
}
</code></pre>
</li>
</ul>
<h3 id="ä¸¤ç§åŠ¨æ€ä»£ç†å¯¹æ¯”">ä¸¤ç§åŠ¨æ€ä»£ç†å¯¹æ¯”</h3>
<ul>
<li>JDKåŠ¨æ€ä»£ç†è¦æ±‚è¢«ä»£ç†çš„ç±»å¿…é¡»æ˜¯è‡³å°‘å®ç°ä¸€ä¸ªæ¥å£æ‰èƒ½ä»£ç†</li>
<li>CglibåŠ¨æ€ä»£ç†æ²¡æœ‰ä¸Šè¿°é™åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´ä»–å¯ä»¥ä»£ç†å®ç°äº†æ¥å£çš„ç±»ï¼Œä¹Ÿå¯ä»¥ä»£ç†æ²¡å®ç°æ¥å£çš„ç±»</li>
<li>JDKåŠ¨æ€ä»£ç†åˆ›å»ºä»£ç†å¯¹è±¡çš„åŸç†æ˜¯è®©åˆ›å»ºçš„ä»£ç†å¯¹è±¡å®ç°å’Œè¢«ä»£ç†ç±»ä¸€æ ·çš„æ¥å£ï¼Œä»è€Œä»£ç†æ¥å£ä¸­çš„æ–¹æ³•</li>
<li>CglibåŠ¨æ€ä»£ç†åˆ›å»ºä»£ç†å¯¹è±¡çš„åŸç†æ˜¯è®©åˆ›å»ºçš„ä»£ç†å¯¹è±¡ç»§æ‰¿è¢«ä»£ç†çš„ç›®æ ‡ç±»ï¼Œä»è€Œä»£ç†ä»çˆ¶ç±»(è¢«ä»£ç†çš„ç±»)ä¸­ç»§æ‰¿è¿‡æ¥çš„æ–¹æ³•</li>
</ul>
<h3 id="å¼ºåˆ¶ä½¿ç”¨cglibæ–¹å¼åˆ›å»ºä»£ç†">å¼ºåˆ¶ä½¿ç”¨Cglibæ–¹å¼åˆ›å»ºä»£ç†</h3>
<p>å¦‚æœä¸Šä¸‹æ–‡å…¥å£æ˜¯XMLé…ç½®æ–‡ä»¶</p>
<pre><code class="language-xml">&lt;!-- æ–¹å¼ä¸€. å±€éƒ¨ --&gt;
&lt;aop:config proxy-target-class=&quot;true&quot;&gt;
    &lt;!-- other beans defined here... --&gt;
&lt;/aop:config&gt;

&lt;!-- æ–¹å¼äºŒ. å…¨å±€ï¼Œåœ¨å¼€å¯æ³¨è§£æ”¯æŒçš„åœ°æ–¹æ·»åŠ å±æ€§(é€šè¿‡æ³¨è§£é…ç½®çš„AOP) --&gt;
&lt;aop:aspectj-autoproxy proxy-target-class=&quot;true&quot;/&gt;
</code></pre>
<p>å¦‚æœä¸Šä¸‹æ–‡å…¥å£æ˜¯æ³¨è§£ç±»</p>
<pre><code class="language-java">@EnableAspectJAutoProxy(proxyTargetClass = true) // å¼€å¯AOPæ³¨è§£æ”¯æŒ,å¹¶å¼ºåˆ¶ä½¿ç”¨cglibä»£ç†
public class MyConfiguration {
}
</code></pre>
<h2 id="springå£°æ˜å¼äº‹åŠ¡">Springå£°æ˜å¼äº‹åŠ¡</h2>
<h3 id="åœ¨xmlä¸­ä½¿ç”¨å£°æ˜å¼äº‹åŠ¡çš„æ­¥éª¤">åœ¨Xmlä¸­ä½¿ç”¨å£°æ˜å¼äº‹åŠ¡çš„æ­¥éª¤</h3>
<ol>
<li>
<p>æ·»åŠ tx schema</p>
<pre><code class="language-xml">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;
       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/tx
       http://www.springframework.org/schema/tx/spring-tx.xsd
       http://www.springframework.org/schema/aop
       https://www.springframework.org/schema/aop/spring-aop.xsd
        http://www.springframework.org/schema/context
       https://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;
</code></pre>
</li>
<li>
<p>é…ç½®æ•°æ®æº</p>
<pre><code class="language-xml">&lt;!-- å¯¼å…¥å¤–éƒ¨propertiesæ–‡ä»¶ --&gt;
&lt;context:property-placeholder location=&quot;jdbc.properties&quot; /&gt;
&lt;!-- é…ç½®æ•°æ®åº“è¿æ¥æ±  --&gt;
&lt;bean id=&quot;dataSource&quot; class=&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;&gt;
    &lt;property name=&quot;url&quot; value=&quot;${jdbc.url}&quot; /&gt;
    &lt;property name=&quot;driverClassName&quot; value=&quot;${jdbc.driver}&quot; /&gt;
    &lt;property name=&quot;username&quot; value=&quot;${jdbc.user}&quot; /&gt;
    &lt;property name=&quot;password&quot; value=&quot;${jdbc.password}&quot; /&gt;
&lt;/bean&gt;
</code></pre>
</li>
<li>
<p>é…ç½®äº‹åŠ¡ç®¡ç†å™¨</p>
<pre><code class="language-xml">&lt;!-- ç¬¬ä¸€æ­¥ï¼š é…ç½®äº‹åŠ¡ç®¡ç†å™¨ --&gt;
&lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;
    &lt;!-- äº‹åŠ¡ç®¡ç†å™¨å¿…é¡»ä¾èµ–æ•°æ®æº --&gt;
    &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;
&lt;/bean&gt;
</code></pre>
</li>
<li>
<p>é…ç½®äº‹åŠ¡é€šçŸ¥ï¼ŒåŒæ—¶è¿˜èƒ½æŒ‡å®šä¸€äº›äº‹åŠ¡ç›¸å…³çš„å…·ä½“å±æ€§</p>
<pre><code class="language-xml">&lt;!-- ç¬¬äºŒæ­¥ï¼š é…ç½®äº‹åŠ¡é€šçŸ¥ï¼ˆä¸åŒäºæˆ‘ä»¬è‡ªå·±ä¹‹å‰é…ç½®çš„å‰ç½®ã€åç½®é€šçŸ¥ï¼Œè¿™ä¸ªæ˜¯Springå¸®æˆ‘ä»¬å°è£…å¥½çš„ï¼Œä¸“é—¨ç”¨æ¥åšäº‹åŠ¡ç®¡ç†çš„é€šçŸ¥ï¼‰ --&gt;
&lt;!-- tx:adviceå°è£…äº†åˆ‡é¢å’Œé€šçŸ¥ç›¸å…³çš„é€»è¾‘ï¼Œä¸éœ€è¦æˆ‘ä»¬è‡ªå·±å†å»ç¼–å†™åˆ‡é¢å’Œé€šçŸ¥çš„é€»è¾‘ --&gt;
&lt;tx:advice id=&quot;txAdvice&quot; transaction-manager=&quot;transactionManager&quot;&gt;
    &lt;tx:attributes&gt;
        &lt;!-- åªæœ‰è§¦å‘äº†ç‰¹å®šå¼‚å¸¸æ‰å›æ»šäº‹åŠ¡ --&gt;
        &lt;tx:method name=&quot;*&quot; rollback-for=&quot;Exception&quot; /&gt;
        &lt;!-- è§¦å‘ä»¥ä¸‹ç‰¹å®šå¼‚å¸¸ï¼Œä¸ä¼šå›æ»šäº‹åŠ¡ --&gt;
        &lt;tx:method name=&quot;*&quot; no-rollback-for=&quot;NullPointerException&quot; /&gt;
        &lt;!-- é…ç½®åªè¯»äº‹åŠ¡ï¼Œåªèƒ½æŸ¥è¯¢ï¼Œä¸èƒ½ä¿®æ”¹ --&gt;
        &lt;tx:method name=&quot;find*&quot; read-only=&quot;true&quot; /&gt;
        &lt;!-- é…ç½®äº‹åŠ¡è¶…æ—¶æ—¶é—´ï¼Œè¶…æ—¶åäº‹åŠ¡è‡ªåŠ¨å›æ»šï¼Œå•ä½ï¼šç§’ï¼Œ
                ä»…å½“ä¼ æ’­è¡Œä¸ºpropagationè®¾ç½®æˆREQUIREDæˆ–è€…REQUIRES_NEWçš„æ—¶å€™æœ‰æ•ˆ --&gt;
        &lt;tx:method name=&quot;find*&quot; timeout=&quot;500&quot; /&gt;
    &lt;/tx:attributes&gt;
&lt;/tx:advice&gt;
</code></pre>
</li>
<li>
<p>é…ç½®äº‹åŠ¡çš„AOP</p>
<p>å…¶å®å°±æ˜¯å°†Springç»™æˆ‘ä»¬å°è£…å¥½çš„äº‹åŠ¡åˆ‡é¢ã€é€šçŸ¥å’Œåˆ‡å…¥ç‚¹æ•´åˆåˆ°ä¸€èµ·ï¼Œé€šè¿‡AOPçš„æ–¹å¼æ¥å·¥ä½œã€‚</p>
<pre><code class="language-xml">&lt;!-- ç¬¬ä¸‰æ­¥ï¼š é…ç½®AOP --&gt;
&lt;aop:config&gt;
    &lt;aop:pointcut id=&quot;allServiceMethod&quot; expression=&quot;execution(* com.lanou3g.spring.aoptx..*.*(..))&quot;/&gt;
    &lt;!-- è¿™ä¸ªadvisorç±»ä¼¼äºæˆ‘ä»¬æ‰‹å·¥é…ç½®çš„aop:aspectï¼Œå®ƒå°†åˆ‡é¢ã€é€šçŸ¥å’Œåˆ‡å…¥ç‚¹åšäº†ä¸€ä¸ªæ•´åˆ --&gt;
    &lt;aop:advisor advice-ref=&quot;txAdvice&quot; pointcut-ref=&quot;allServiceMethod&quot; /&gt;
&lt;/aop:config&gt;
</code></pre>
</li>
</ol>
<h3 id="åœ¨æ³¨è§£ä¸­ä½¿ç”¨å£°æ˜å¼äº‹åŠ¡çš„æ­¥éª¤">åœ¨æ³¨è§£ä¸­ä½¿ç”¨å£°æ˜å¼äº‹åŠ¡çš„æ­¥éª¤</h3>
<ol>
<li>
<p>å¼€å¯æ³¨è§£äº‹åŠ¡æ”¯æŒ</p>
<p>å¼€å¯æ³¨è§£äº‹åŠ¡æ”¯æŒæœ‰ä¸¤ç§æ–¹å¼</p>
<p>æ–¹å¼ä¸€ï¼š åœ¨xmlé…ç½®æ–‡ä»¶ä¸­å¼€å¯</p>
<pre><code class="language-xml">&lt;!-- å¼€å¯äº‹åŠ¡æ³¨è§£æ‰«æ --&gt;
&lt;!-- å¦‚æœå®šä¹‰çš„äº‹åŠ¡ç®¡ç†å™¨åç§°å°±å«transactionManagerï¼Œåˆ™æ­¤å±æ€§å¯ä»¥çœç•¥ --&gt;
&lt;tx:annotation-driven transaction-manager=&quot;txManager&quot; /&gt;
</code></pre>
<p>æ–¹å¼äºŒï¼šåœ¨æ³¨è§£é…ç½®ç±»ä¸Šå¼€å¯ï¼Œæ·»åŠ <code>@EnableTransactionManagement</code>æ³¨è§£</p>
<pre><code class="language-java">@Configuration
@EnableTransactionManagement
@ComponentScan(basePackages = &quot;com.lanou3g.spring&quot;)
@PropertySource(&quot;classpath:jdbc.properties&quot;)
public class MyConfiguration {
    
}
</code></pre>
</li>
<li>
<p>é…ç½®æ•°æ®æº</p>
<pre><code class="language-java">/**
* é…ç½®æ•°æ®æº
* @return
*/
@Bean
public DataSource dataSource() {
    DriverManagerDataSource dataSource = new DriverManagerDataSource();
    dataSource.setDriverClassName(driver);
    dataSource.setUrl(url);
    dataSource.setUsername(user);
    dataSource.setPassword(password);
    return dataSource;
}
</code></pre>
</li>
<li>
<p>é…ç½®äº‹åŠ¡ç®¡ç†å™¨</p>
<pre><code class="language-java">/**
 * é…ç½®äº‹åŠ¡ç®¡ç†å™¨
 * @param dataSource
 * @return
 */
@Bean
public PlatformTransactionManager transactionManager(DataSource dataSource) {
    return new DataSourceTransactionManager(dataSource);
}
</code></pre>
</li>
<li>
<p>åœ¨éœ€è¦äº‹åŠ¡ç®¡ç†çš„æ–¹æ³•ä¸Šæ·»åŠ <code>@Transactional</code>æ³¨è§£</p>
<pre><code class="language-java">// å‡¡æ˜¯xmlä¸­æ”¯æŒçš„äº‹åŠ¡å±æ€§ï¼Œåœ¨æ³¨è§£ä¸­éƒ½æœ‰å¯¹åº”çš„å±æ€§æ¥å®ç°ï¼Œå…·ä½“å±æ€§å«ä¹‰å‚è§xmlé…ç½®
@Transactional(
    rollbackFor = Exception.class   // æŒ‡å®šå“ªäº›å¼‚å¸¸å¯ä»¥è§¦å‘äº‹åŠ¡å›æ»š
    //noRollbackFor =   // æŒ‡å®šäº‹åŠ¡ä¸å›æ»šå“ªäº›å¼‚å¸¸
    //            isolation =   // æŒ‡å®šäº‹åŠ¡éš”ç¦»çº§åˆ«
    //            timeout =     // æŒ‡å®šäº‹åŠ¡è¶…æ—¶æ—¶é—´
    //            propagation = // æŒ‡å®šäº‹åŠ¡ä¼ æ’­è¡Œä¸º
    //            readOnly = // æŒ‡å®šåªè¯»äº‹åŠ¡
)
public void login(User user) {

    // Serviceä¸­åªå†™ä¸šåŠ¡æ“ä½œä»£ç ï¼Œä¸éœ€è¦å…³æ³¨äº‹åŠ¡ç®¡ç†
    // 1 æ›´æ–°ç”¨æˆ·è¡¨ç”¨æˆ·æœ€åç™»å½•æ—¶é—´
    user.setLastLoginTime(new Timestamp(System.currentTimeMillis()));
    userDao.updateUser(user);

    int ret = 9 / 0;  // æ¨¡æ‹Ÿæ“ä½œå¼‚å¸¸

    // 2 æ’å…¥ç™»å½•æ—¥å¿—
    SystemLog log = new SystemLog();
    log.setAction(&quot;login&quot;);
    log.setOperator(user.getUserName());
    log.setCreateTime(new Date());
    systemLogDao.insertLog(log);
}
</code></pre>
<blockquote>
<p>@Transactionalæ³¨è§£é™¤äº†å¯ä»¥åœ¨æ–¹æ³•ä¸Šä½¿ç”¨å¤–ï¼Œè¿˜å¯ä»¥åœ¨ç±»ä¸Šã€‚è¡¨ç¤ºç±»ä¸­æ‰€æœ‰çš„å…¬å¼€æ–¹æ³•éƒ½æ·»åŠ æ­¤äº‹åŠ¡ç®¡ç†</p>
</blockquote>
</li>
</ol>
<h3 id="xmlæ–¹å¼çš„äº‹åŠ¡å’Œæ³¨è§£æ–¹å¼çš„äº‹åŠ¡è¯¥é€‰å“ªä¸ª">XMLæ–¹å¼çš„äº‹åŠ¡å’Œæ³¨è§£æ–¹å¼çš„äº‹åŠ¡è¯¥é€‰å“ªä¸ªï¼Ÿ</h3>
<ul>
<li>XMLæ–¹å¼çš„äº‹åŠ¡
<ul>
<li>ä¼˜ç‚¹æ˜¯å¯¹ä»£ç æ²¡æœ‰ä»»ä½•ä¾µå…¥æ€§ï¼Œä¿®æ”¹äº‹åŠ¡ç›¸å…³é€»è¾‘æ—¶ï¼Œåªéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œæ— éœ€é‡æ–°ç¼–è¯‘ä»£ç ã€‚å¦å¤–XMLæ–¹å¼å¯ä»¥é€šè¿‡åˆ‡å…¥ç‚¹è¡¨è¾¾å¼çµæ´»çš„å¯¹å¤§é‡çš„ç±»æ·»åŠ äº‹åŠ¡ç®¡ç†ã€‚</li>
<li>ç¼ºç‚¹æ˜¯é…ç½®ç›¸è¾ƒäºæ³¨è§£æ–¹å¼éº»çƒ¦ä¸€äº›</li>
</ul>
</li>
<li>æ³¨è§£æ–¹å¼çš„äº‹åŠ¡
<ul>
<li>ä¼˜ç‚¹æ˜¯é…ç½®ç®€å•ï¼Œä½¿ç”¨æ–¹ä¾¿</li>
<li>ç¼ºç‚¹æ˜¯æ— æ³•ç»Ÿä¸€å¯¹å¤§é‡çš„æ–¹æ³•æ·»åŠ äº‹åŠ¡ç®¡ç†ï¼Œéœ€è¦åœ¨æ·»åŠ äº‹åŠ¡çš„ç±»æˆ–æ–¹æ³•ä¸Šä¸€ä¸ªä¸ªæ·»åŠ äº‹åŠ¡æ³¨è§£ï¼Œå½“å·¥ç¨‹ä¸­éœ€è¦äº‹åŠ¡ç®¡ç†çš„ä»£ç å¾ˆå¤šæ—¶ï¼Œå·¥ä½œé‡å°±æ¯”XMLæ–¹å¼è¿˜è¦å¤§ã€‚</li>
</ul>
</li>
</ul>
<h3 id="springäº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºå’Œéš”ç¦»çº§åˆ«">Springäº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºå’Œéš”ç¦»çº§åˆ«</h3>
<h4 id="äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º">äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º</h4>
<p>äº‹åŠ¡ä¼ æ’­æè¿°çš„äº‹åŠ¡ä¸äº‹åŠ¡ä¹‹é—´çš„ä¼ æ’­å…³ç³»ï¼Œ å¸¸è§çš„åœºæ™¯æ˜¯åœ¨ä¸€ä¸ªåµŒå¥—è°ƒç”¨çš„æ–¹æ³•ä¸­ï¼Œå¤–éƒ¨æ–¹æ³•å’Œå†…éƒ¨æ¯ä¸ªæ–¹æ³•éƒ½æ·»åŠ äº†äº‹åŠ¡ç®¡ç†ï¼Œ ä¸åŒçš„ä¼ æ’­è¡Œä¸ºé…ç½®ï¼Œå†³å®šäº†æœ€ç»ˆæ˜¯è¿™äº›æ–¹æ³•æ˜¯ä½¿ç”¨åŒä¸€ä¸ªäº‹åŠ¡ï¼Œè¿˜æ˜¯åœ¨ä¸åŒçš„äº‹åŠ¡ä¸­è¿è¡Œã€‚</p>
<ul>
<li>
<p>PROPAGATION_REQUIRED</p>
<p>æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±æ–°å»ºä¸€ä¸ªäº‹åŠ¡ã€‚è¿™æ˜¯æœ€å¸¸è§çš„é€‰æ‹©ã€‚</p>
</li>
<li>
<p>PROPAGATION_SUPPORTS</p>
<p>æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œã€‚</p>
</li>
<li>
<p>PROPAGATION_MANDATORY</p>
<p>æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚</p>
</li>
<li>
<p>PROPAGATION_REQUIRES_NEW</p>
<p>æ–°å»ºäº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼ŒæŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚</p>
</li>
<li>
<p>PROPAGATION_NOT_SUPPORTED</p>
<p>ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œæ“ä½œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚</p>
</li>
<li>
<p>PROPAGATION_NEVER</p>
<p>ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</p>
</li>
<li>
<p>PROPAGATION_NESTED</p>
<p>å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åœ¨åµŒå¥—äº‹åŠ¡å†…æ‰§è¡Œã€‚å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™è¿›è¡Œä¸PROPAGATION_REQUIREDç±»ä¼¼çš„æ“ä½œã€‚</p>
</li>
</ul>
<h4 id="äº‹åŠ¡çš„éš”ç¦»çº§åˆ«">äº‹åŠ¡çš„éš”ç¦»çº§åˆ«</h4>
<p>äº‹åŠ¡çš„éš”ç¦»çº§åˆ«æè¿°çš„æ˜¯å¤šä¸ªäº‹åŠ¡ä¹‹é—´çš„å¯è§æ€§é—®é¢˜ã€‚æ¯”å¦‚ä¸€ä¸ªäº‹åŠ¡è¿˜æœªæäº¤æ—¶ï¼Œå…¶ä»–äº‹åŠ¡æ˜¯å¦èƒ½çœ‹åˆ°è¢«æœªæäº¤äº‹åŠ¡ä¿®æ”¹çš„æ•°æ®ã€‚</p>
<table>
<thead>
<tr>
<th>éš”ç¦»çº§åˆ«</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>ISOLATION_DEFAULT</td>
<td>è¿™æ˜¯ä¸€ä¸ªPlatfromTransactionManageré»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼Œä½¿ç”¨æ•°æ®åº“é»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«.</td>
</tr>
<tr>
<td>ISOLATION_READ_UNCOMMITTED</td>
<td>è¿™æ˜¯äº‹åŠ¡æœ€ä½çš„éš”ç¦»çº§åˆ«ï¼Œå®ƒå…è®¸å¦å¤–ä¸€ä¸ªäº‹åŠ¡å¯ä»¥çœ‹åˆ°è¿™ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ®ã€‚ è¿™ç§éš”ç¦»çº§åˆ«ä¼šäº§ç”Ÿè„è¯»ï¼Œä¸å¯é‡å¤è¯»å’Œå¹»åƒè¯»ã€‚</td>
</tr>
<tr>
<td>ISOLATION_READ_COMMITTED</td>
<td>ä¿è¯ä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹çš„æ•°æ®æäº¤åæ‰èƒ½è¢«å¦å¤–ä¸€ä¸ªäº‹åŠ¡è¯»å–ã€‚å¦å¤–ä¸€ä¸ªäº‹åŠ¡ä¸èƒ½è¯»å–è¯¥äº‹åŠ¡æœªæäº¤çš„æ•°æ®ã€‚ è¿™ç§äº‹åŠ¡éš”ç¦»çº§åˆ«å¯ä»¥é¿å…è„è¯»å‡ºç°ï¼Œä½†æ˜¯å¯èƒ½ä¼šå‡ºç°ä¸å¯é‡å¤è¯»å’Œå¹»åƒè¯»ã€‚</td>
</tr>
<tr>
<td>ISOLATION_REPEATABLE_READ</td>
<td>è¿™ç§äº‹åŠ¡éš”ç¦»çº§åˆ«å¯ä»¥é˜²æ­¢è„è¯»ã€ä¸å¯é‡å¤è¯»ã€‚ä½†æ˜¯å¯èƒ½å‡ºç°å¹»åƒè¯»ã€‚ å®ƒä¿è¯äº†ä¸€ä¸ªäº‹åŠ¡ä¸èƒ½ä¿®æ”¹å·²ç»ç”±å¦ä¸€ä¸ªäº‹åŠ¡è¯»å–ä½†è¿˜æœªæäº¤çš„æ•°æ®</td>
</tr>
<tr>
<td>ISOLATION_SERIALIZABLE</td>
<td>è¿™æ˜¯èŠ±è´¹æœ€é«˜ä»£ä»·ä½†æ˜¯æœ€å¯é çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ã€‚äº‹åŠ¡è¢«å¤„ç†ä¸ºé¡ºåºæ‰§è¡Œã€‚ é™¤äº†é˜²æ­¢è„è¯»ï¼Œä¸å¯é‡å¤è¯»å¤–ï¼Œè¿˜é¿å…äº†å¹»åƒè¯»ã€‚</td>
</tr>
</tbody>
</table>
<h5 id="å…³é”®è¯">å…³é”®è¯ï¼š</h5>
<ul>
<li>å¹»è¯»ï¼ˆè™šè¯»ï¼‰</li>
</ul>
<blockquote>
<p>äº‹åŠ¡1è¯»å–è®°å½•æ—¶äº‹åŠ¡2å¢åŠ äº†è®°å½•å¹¶æäº¤ï¼Œäº‹åŠ¡1å†æ¬¡è¯»å–æ—¶å¯ä»¥çœ‹åˆ°äº‹åŠ¡2æ–°å¢çš„è®°å½•ï¼›<br>
é€šä¿—çš„è¯´ï¼Œå¹»è¯»å°±æ˜¯æŒ‡åœ¨ä¸€ä¸ªäº‹åŠ¡å†…è¯»å–äº†åˆ«çš„äº‹åŠ¡æ’å…¥çš„æ•°æ®ï¼Œå¯¼è‡´å‰åè¯»å–ä¸ä¸€è‡´(insert)</p>
</blockquote>
<ul>
<li>ä¸å¯é‡å¤è¯»å–</li>
</ul>
<blockquote>
<p>äº‹åŠ¡1è¯»å–è®°å½•æ—¶ï¼Œäº‹åŠ¡2æ›´æ–°äº†è®°å½•å¹¶æäº¤ï¼Œäº‹åŠ¡1å†æ¬¡è¯»å–æ—¶å¯ä»¥çœ‹åˆ°äº‹åŠ¡2ä¿®æ”¹åçš„è®°å½•ï¼›<br>
åœ¨ä¸€ä¸ªäº‹åŠ¡å†…è¯»å–è¡¨ä¸­çš„æŸä¸€è¡Œæ•°æ®,å¤šæ¬¡è¯»å–ç»“æœä¸åŒ.ä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°äº†å¦ä¸€ä¸ªäº‹åŠ¡æäº¤åçš„æ•°æ®.</p>
</blockquote>
<ul>
<li>è„è¯»</li>
</ul>
<blockquote>
<p>äº‹åŠ¡1æ›´æ–°äº†è®°å½•ï¼Œä½†æ²¡æœ‰æäº¤ï¼Œäº‹åŠ¡2è¯»å–äº†æ›´æ–°åçš„è¡Œï¼Œç„¶åäº‹åŠ¡T1å›æ»šï¼Œç°åœ¨T2è¯»å–æ— æ•ˆã€‚<br>
é€šä¿—çš„è¯´ï¼Œè„è¯»å°±æ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡è¯»å–äº†ä¸€ä¸ªæœªæäº¤äº‹åŠ¡çš„æ•°æ®</p>
</blockquote>
]]></content>
    </entry>
</feed>